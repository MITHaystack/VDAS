<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Mark6: src/extern/PF_RING-4.7.0/userland/tcpdump-4.1.1/print-rsvp.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mark6</div>
   <div id="projectbrief">Mark6 VLBI data acquisition software.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_249616ead0532db7c581c28062f7a49e.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_99a38eff05bc1388efa7bcbb456e2008.html">extern</a>      </li>
      <li class="navelem"><a class="el" href="dir_53c688ba8854e22dd560901b085b7a24.html">PF_RING-4.7.0</a>      </li>
      <li class="navelem"><a class="el" href="dir_e1ebd79ad454b9bb4e17c3fdb9c56974.html">userland</a>      </li>
      <li class="navelem"><a class="el" href="dir_9e16ba0a662b9e1dc74f25b43644e518.html">tcpdump-4.1.1</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">print-rsvp.c</div>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 1998-2007 The TCPDUMP project</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00005"></a>00005 <span class="comment"> * modification, are permitted provided that: (1) source code</span>
<a name="l00006"></a>00006 <span class="comment"> * distributions retain the above copyright notice and this paragraph</span>
<a name="l00007"></a>00007 <span class="comment"> * in its entirety, and (2) distributions including binary code include</span>
<a name="l00008"></a>00008 <span class="comment"> * the above copyright notice and this paragraph in its entirety in</span>
<a name="l00009"></a>00009 <span class="comment"> * the documentation or other materials provided with the distribution.</span>
<a name="l00010"></a>00010 <span class="comment"> * THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND</span>
<a name="l00011"></a>00011 <span class="comment"> * WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT</span>
<a name="l00012"></a>00012 <span class="comment"> * LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</span>
<a name="l00013"></a>00013 <span class="comment"> * FOR A PARTICULAR PURPOSE.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> * Original code by Hannes Gredler (hannes@juniper.net)</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef lint</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> rcsid[] _U_ =
<a name="l00020"></a>00020     <span class="stringliteral">&quot;@(#) $Header: /tcpdump/master/tcpdump/print-rsvp.c,v 1.50 2008-08-16 11:36:20 hannes Exp $&quot;</span>;
<a name="l00021"></a>00021 <span class="preprocessor">#endif</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#include &quot;config.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#endif</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;tcpdump-stdinc.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;interface.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;extract.h&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;addrtoname.h&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;ethertype.h&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;gmpls.h&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;af.h&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;signature.h&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">/*</span>
<a name="l00042"></a>00042 <span class="comment"> * RFC 2205 common header</span>
<a name="l00043"></a>00043 <span class="comment"> *</span>
<a name="l00044"></a>00044 <span class="comment"> *               0             1              2             3</span>
<a name="l00045"></a>00045 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00046"></a>00046 <span class="comment"> *        | Vers | Flags|  Msg Type   |       RSVP Checksum       |</span>
<a name="l00047"></a>00047 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00048"></a>00048 <span class="comment"> *        |  Send_TTL   | (Reserved)  |        RSVP Length        |</span>
<a name="l00049"></a>00049 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00050"></a>00050 <span class="comment"> *</span>
<a name="l00051"></a>00051 <span class="comment"> */</span>
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="structrsvp__common__header.html">00053</a> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a> {
<a name="l00054"></a>00054     u_int8_t version_flags;
<a name="l00055"></a>00055     u_int8_t msg_type;
<a name="l00056"></a>00056     u_int8_t checksum[2];
<a name="l00057"></a>00057     u_int8_t ttl;
<a name="l00058"></a>00058     u_int8_t reserved;
<a name="l00059"></a>00059     u_int8_t length[2];
<a name="l00060"></a>00060 };
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/* </span>
<a name="l00063"></a>00063 <span class="comment"> * RFC2205 object header</span>
<a name="l00064"></a>00064 <span class="comment"> *</span>
<a name="l00065"></a>00065 <span class="comment"> * </span>
<a name="l00066"></a>00066 <span class="comment"> *               0             1              2             3</span>
<a name="l00067"></a>00067 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00068"></a>00068 <span class="comment"> *        |       Length (bytes)      |  Class-Num  |   C-Type    |</span>
<a name="l00069"></a>00069 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00070"></a>00070 <span class="comment"> *        |                                                       |</span>
<a name="l00071"></a>00071 <span class="comment"> *        //                  (Object contents)                   //</span>
<a name="l00072"></a>00072 <span class="comment"> *        |                                                       |</span>
<a name="l00073"></a>00073 <span class="comment"> *        +-------------+-------------+-------------+-------------+</span>
<a name="l00074"></a>00074 <span class="comment"> */</span>
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="structrsvp__object__header.html">00076</a> <span class="keyword">struct </span><a class="code" href="structrsvp__object__header.html">rsvp_object_header</a> {
<a name="l00077"></a>00077     u_int8_t length[2];
<a name="l00078"></a>00078     u_int8_t class_num;
<a name="l00079"></a>00079     u_int8_t ctype;
<a name="l00080"></a>00080 };
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="preprocessor">#define RSVP_VERSION            1</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_EXTRACT_VERSION(x) (((x)&amp;0xf0)&gt;&gt;4) </span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_EXTRACT_FLAGS(x)   ((x)&amp;0x0f)</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="preprocessor">#define RSVP_MSGTYPE_PATH       1</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_RESV       2</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_PATHERR    3</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_RESVERR    4</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_PATHTEAR   5</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_RESVTEAR   6</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_RESVCONF   7</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_AGGREGATE  12</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_ACK        13</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_HELLO_OLD  14      </span><span class="comment">/* ancient Hellos */</span>
<a name="l00096"></a>00096 <span class="preprocessor">#define RSVP_MSGTYPE_SREFRESH   15</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_MSGTYPE_HELLO      20</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_msg_type_values[] = {
<a name="l00100"></a>00100     { RSVP_MSGTYPE_PATH,    <span class="stringliteral">&quot;Path&quot;</span> },
<a name="l00101"></a>00101     { RSVP_MSGTYPE_RESV,    <span class="stringliteral">&quot;Resv&quot;</span> },
<a name="l00102"></a>00102     { RSVP_MSGTYPE_PATHERR, <span class="stringliteral">&quot;PathErr&quot;</span> },
<a name="l00103"></a>00103     { RSVP_MSGTYPE_RESVERR, <span class="stringliteral">&quot;ResvErr&quot;</span> },
<a name="l00104"></a>00104     { RSVP_MSGTYPE_PATHTEAR,    <span class="stringliteral">&quot;PathTear&quot;</span> },
<a name="l00105"></a>00105     { RSVP_MSGTYPE_RESVTEAR,    <span class="stringliteral">&quot;ResvTear&quot;</span> },
<a name="l00106"></a>00106     { RSVP_MSGTYPE_RESVCONF,    <span class="stringliteral">&quot;ResvConf&quot;</span> },
<a name="l00107"></a>00107     { RSVP_MSGTYPE_AGGREGATE,   <span class="stringliteral">&quot;Aggregate&quot;</span> },
<a name="l00108"></a>00108     { RSVP_MSGTYPE_ACK,         <span class="stringliteral">&quot;Acknowledgement&quot;</span> },
<a name="l00109"></a>00109     { RSVP_MSGTYPE_HELLO_OLD,   <span class="stringliteral">&quot;Hello (Old)&quot;</span> },
<a name="l00110"></a>00110     { RSVP_MSGTYPE_SREFRESH,    <span class="stringliteral">&quot;Refresh&quot;</span> },
<a name="l00111"></a>00111     { RSVP_MSGTYPE_HELLO,   <span class="stringliteral">&quot;Hello&quot;</span> },
<a name="l00112"></a>00112     { 0, NULL}
<a name="l00113"></a>00113 };
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_header_flag_values[] = {
<a name="l00116"></a>00116     { 0x01,               <span class="stringliteral">&quot;Refresh reduction capable&quot;</span> }, <span class="comment">/* rfc2961 */</span>
<a name="l00117"></a>00117     { 0, NULL}
<a name="l00118"></a>00118 };
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="preprocessor">#define RSVP_OBJ_SESSION            1   </span><span class="comment">/* rfc2205 */</span>
<a name="l00121"></a>00121 <span class="preprocessor">#define RSVP_OBJ_RSVP_HOP           3   </span><span class="comment">/* rfc2205, rfc3473 */</span>
<a name="l00122"></a>00122 <span class="preprocessor">#define RSVP_OBJ_INTEGRITY          4   </span><span class="comment">/* rfc2747 */</span>
<a name="l00123"></a>00123 <span class="preprocessor">#define RSVP_OBJ_TIME_VALUES        5   </span><span class="comment">/* rfc2205 */</span>
<a name="l00124"></a>00124 <span class="preprocessor">#define RSVP_OBJ_ERROR_SPEC         6 </span>
<a name="l00125"></a>00125 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_SCOPE              7</span>
<a name="l00126"></a>00126 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_STYLE              8   </span><span class="comment">/* rfc2205 */</span>
<a name="l00127"></a>00127 <span class="preprocessor">#define RSVP_OBJ_FLOWSPEC           9   </span><span class="comment">/* rfc2215 */</span>
<a name="l00128"></a>00128 <span class="preprocessor">#define RSVP_OBJ_FILTERSPEC         10  </span><span class="comment">/* rfc2215 */</span>
<a name="l00129"></a>00129 <span class="preprocessor">#define RSVP_OBJ_SENDER_TEMPLATE    11</span>
<a name="l00130"></a>00130 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_SENDER_TSPEC       12  </span><span class="comment">/* rfc2215 */</span>
<a name="l00131"></a>00131 <span class="preprocessor">#define RSVP_OBJ_ADSPEC             13  </span><span class="comment">/* rfc2215 */</span>
<a name="l00132"></a>00132 <span class="preprocessor">#define RSVP_OBJ_POLICY_DATA        14</span>
<a name="l00133"></a>00133 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_CONFIRM            15  </span><span class="comment">/* rfc2205 */</span>
<a name="l00134"></a>00134 <span class="preprocessor">#define RSVP_OBJ_LABEL              16  </span><span class="comment">/* rfc3209 */</span>
<a name="l00135"></a>00135 <span class="preprocessor">#define RSVP_OBJ_LABEL_REQ          19  </span><span class="comment">/* rfc3209 */</span>
<a name="l00136"></a>00136 <span class="preprocessor">#define RSVP_OBJ_ERO                20  </span><span class="comment">/* rfc3209 */</span>
<a name="l00137"></a>00137 <span class="preprocessor">#define RSVP_OBJ_RRO                21  </span><span class="comment">/* rfc3209 */</span>
<a name="l00138"></a>00138 <span class="preprocessor">#define RSVP_OBJ_HELLO              22  </span><span class="comment">/* rfc3209 */</span>
<a name="l00139"></a>00139 <span class="preprocessor">#define RSVP_OBJ_MESSAGE_ID         23  </span><span class="comment">/* rfc2961 */</span>
<a name="l00140"></a>00140 <span class="preprocessor">#define RSVP_OBJ_MESSAGE_ID_ACK     24  </span><span class="comment">/* rfc2961 */</span>
<a name="l00141"></a>00141 <span class="preprocessor">#define RSVP_OBJ_MESSAGE_ID_LIST    25  </span><span class="comment">/* rfc2961 */</span>
<a name="l00142"></a>00142 <span class="preprocessor">#define RSVP_OBJ_RECOVERY_LABEL     34  </span><span class="comment">/* rfc3473 */</span>
<a name="l00143"></a>00143 <span class="preprocessor">#define RSVP_OBJ_UPSTREAM_LABEL     35  </span><span class="comment">/* rfc3473 */</span>
<a name="l00144"></a>00144 <span class="preprocessor">#define RSVP_OBJ_LABEL_SET          36  </span><span class="comment">/* rfc3473 */</span>
<a name="l00145"></a>00145 <span class="preprocessor">#define RSVP_OBJ_PROTECTION         37  </span><span class="comment">/* rfc3473 */</span>
<a name="l00146"></a>00146 <span class="preprocessor">#define RSVP_OBJ_S2L                50  </span><span class="comment">/* rfc4875 */</span>
<a name="l00147"></a>00147 <span class="preprocessor">#define RSVP_OBJ_DETOUR             63  </span><span class="comment">/* draft-ietf-mpls-rsvp-lsp-fastreroute-07 */</span>
<a name="l00148"></a>00148 <span class="preprocessor">#define RSVP_OBJ_CLASSTYPE          66  </span><span class="comment">/* rfc4124 */</span>
<a name="l00149"></a>00149 <span class="preprocessor">#define RSVP_OBJ_CLASSTYPE_OLD      125 </span><span class="comment">/* draft-ietf-tewg-diff-te-proto-07 */</span>
<a name="l00150"></a>00150 <span class="preprocessor">#define RSVP_OBJ_SUGGESTED_LABEL    129 </span><span class="comment">/* rfc3473 */</span>
<a name="l00151"></a>00151 <span class="preprocessor">#define RSVP_OBJ_ACCEPT_LABEL_SET   130 </span><span class="comment">/* rfc3473 */</span>
<a name="l00152"></a>00152 <span class="preprocessor">#define RSVP_OBJ_RESTART_CAPABILITY 131 </span><span class="comment">/* rfc3473 */</span>
<a name="l00153"></a>00153 <span class="preprocessor">#define RSVP_OBJ_NOTIFY_REQ         195 </span><span class="comment">/* rfc3473 */</span>
<a name="l00154"></a>00154 <span class="preprocessor">#define RSVP_OBJ_ADMIN_STATUS       196 </span><span class="comment">/* rfc3473 */</span>
<a name="l00155"></a>00155 <span class="preprocessor">#define RSVP_OBJ_PROPERTIES         204 </span><span class="comment">/* juniper proprietary */</span>
<a name="l00156"></a>00156 <span class="preprocessor">#define RSVP_OBJ_FASTREROUTE        205 </span><span class="comment">/* draft-ietf-mpls-rsvp-lsp-fastreroute-07 */</span>
<a name="l00157"></a>00157 <span class="preprocessor">#define RSVP_OBJ_SESSION_ATTRIBUTE  207 </span><span class="comment">/* rfc3209 */</span>
<a name="l00158"></a>00158 <span class="preprocessor">#define RSVP_OBJ_GENERALIZED_UNI    229 </span><span class="comment">/* OIF RSVP extensions UNI 1.0 Signaling, Rel. 2 */</span>
<a name="l00159"></a>00159 <span class="preprocessor">#define RSVP_OBJ_CALL_ID            230 </span><span class="comment">/* rfc3474 */</span>
<a name="l00160"></a>00160 <span class="preprocessor">#define RSVP_OBJ_CALL_OPS           236 </span><span class="comment">/* rfc3474 */</span>
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_values[] = {
<a name="l00163"></a>00163     { RSVP_OBJ_SESSION,            <span class="stringliteral">&quot;Session&quot;</span> },
<a name="l00164"></a>00164     { RSVP_OBJ_RSVP_HOP,           <span class="stringliteral">&quot;RSVP Hop&quot;</span> },
<a name="l00165"></a>00165     { RSVP_OBJ_INTEGRITY,          <span class="stringliteral">&quot;Integrity&quot;</span> },
<a name="l00166"></a>00166     { RSVP_OBJ_TIME_VALUES,        <span class="stringliteral">&quot;Time Values&quot;</span> },
<a name="l00167"></a>00167     { RSVP_OBJ_ERROR_SPEC,         <span class="stringliteral">&quot;Error Spec&quot;</span> },
<a name="l00168"></a>00168     { RSVP_OBJ_SCOPE,              <span class="stringliteral">&quot;Scope&quot;</span> },
<a name="l00169"></a>00169     { RSVP_OBJ_STYLE,              <span class="stringliteral">&quot;Style&quot;</span> },
<a name="l00170"></a>00170     { RSVP_OBJ_FLOWSPEC,           <span class="stringliteral">&quot;Flowspec&quot;</span> },
<a name="l00171"></a>00171     { RSVP_OBJ_FILTERSPEC,         <span class="stringliteral">&quot;FilterSpec&quot;</span> },
<a name="l00172"></a>00172     { RSVP_OBJ_SENDER_TEMPLATE,    <span class="stringliteral">&quot;Sender Template&quot;</span> },
<a name="l00173"></a>00173     { RSVP_OBJ_SENDER_TSPEC,       <span class="stringliteral">&quot;Sender TSpec&quot;</span> },
<a name="l00174"></a>00174     { RSVP_OBJ_ADSPEC,             <span class="stringliteral">&quot;Adspec&quot;</span> },
<a name="l00175"></a>00175     { RSVP_OBJ_POLICY_DATA,        <span class="stringliteral">&quot;Policy Data&quot;</span> },
<a name="l00176"></a>00176     { RSVP_OBJ_CONFIRM,            <span class="stringliteral">&quot;Confirm&quot;</span> },
<a name="l00177"></a>00177     { RSVP_OBJ_LABEL,              <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00178"></a>00178     { RSVP_OBJ_LABEL_REQ,          <span class="stringliteral">&quot;Label Request&quot;</span> },
<a name="l00179"></a>00179     { RSVP_OBJ_ERO,                <span class="stringliteral">&quot;ERO&quot;</span> },
<a name="l00180"></a>00180     { RSVP_OBJ_RRO,                <span class="stringliteral">&quot;RRO&quot;</span> },
<a name="l00181"></a>00181     { RSVP_OBJ_HELLO,              <span class="stringliteral">&quot;Hello&quot;</span> },
<a name="l00182"></a>00182     { RSVP_OBJ_MESSAGE_ID,         <span class="stringliteral">&quot;Message ID&quot;</span> },
<a name="l00183"></a>00183     { RSVP_OBJ_MESSAGE_ID_ACK,     <span class="stringliteral">&quot;Message ID Ack&quot;</span> },
<a name="l00184"></a>00184     { RSVP_OBJ_MESSAGE_ID_LIST,    <span class="stringliteral">&quot;Message ID List&quot;</span> },
<a name="l00185"></a>00185     { RSVP_OBJ_RECOVERY_LABEL,     <span class="stringliteral">&quot;Recovery Label&quot;</span> },
<a name="l00186"></a>00186     { RSVP_OBJ_UPSTREAM_LABEL,     <span class="stringliteral">&quot;Upstream Label&quot;</span> },
<a name="l00187"></a>00187     { RSVP_OBJ_LABEL_SET,          <span class="stringliteral">&quot;Label Set&quot;</span> },
<a name="l00188"></a>00188     { RSVP_OBJ_ACCEPT_LABEL_SET,   <span class="stringliteral">&quot;Acceptable Label Set&quot;</span> },
<a name="l00189"></a>00189     { RSVP_OBJ_DETOUR,             <span class="stringliteral">&quot;Detour&quot;</span> },
<a name="l00190"></a>00190     { RSVP_OBJ_CLASSTYPE,          <span class="stringliteral">&quot;Class Type&quot;</span> },
<a name="l00191"></a>00191     { RSVP_OBJ_CLASSTYPE_OLD,      <span class="stringliteral">&quot;Class Type (old)&quot;</span> },
<a name="l00192"></a>00192     { RSVP_OBJ_SUGGESTED_LABEL,    <span class="stringliteral">&quot;Suggested Label&quot;</span> },
<a name="l00193"></a>00193     { RSVP_OBJ_PROPERTIES,         <span class="stringliteral">&quot;Properties&quot;</span> },
<a name="l00194"></a>00194     { RSVP_OBJ_FASTREROUTE,        <span class="stringliteral">&quot;Fast Re-Route&quot;</span> },
<a name="l00195"></a>00195     { RSVP_OBJ_SESSION_ATTRIBUTE,  <span class="stringliteral">&quot;Session Attribute&quot;</span> },
<a name="l00196"></a>00196     { RSVP_OBJ_GENERALIZED_UNI,    <span class="stringliteral">&quot;Generalized UNI&quot;</span> },
<a name="l00197"></a>00197     { RSVP_OBJ_CALL_ID,            <span class="stringliteral">&quot;Call-ID&quot;</span> },
<a name="l00198"></a>00198     { RSVP_OBJ_CALL_OPS,           <span class="stringliteral">&quot;Call Capability&quot;</span> },
<a name="l00199"></a>00199     { RSVP_OBJ_RESTART_CAPABILITY, <span class="stringliteral">&quot;Restart Capability&quot;</span> },
<a name="l00200"></a>00200     { RSVP_OBJ_NOTIFY_REQ,         <span class="stringliteral">&quot;Notify Request&quot;</span> },
<a name="l00201"></a>00201     { RSVP_OBJ_PROTECTION,         <span class="stringliteral">&quot;Protection&quot;</span> },
<a name="l00202"></a>00202     { RSVP_OBJ_ADMIN_STATUS,       <span class="stringliteral">&quot;Administrative Status&quot;</span> },
<a name="l00203"></a>00203     { RSVP_OBJ_S2L,                <span class="stringliteral">&quot;Sub-LSP to LSP&quot;</span> },
<a name="l00204"></a>00204     { 0, NULL}
<a name="l00205"></a>00205 };
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="preprocessor">#define RSVP_CTYPE_IPV4        1</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_IPV6        2</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_TUNNEL_IPV4 7</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_TUNNEL_IPV6 8</span>
<a name="l00211"></a>00211 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_UNI_IPV4    11 </span><span class="comment">/* OIF RSVP extensions UNI 1.0 Signaling Rel. 2 */</span>
<a name="l00212"></a>00212 <span class="preprocessor">#define RSVP_CTYPE_1           1</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_2           2</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_3           3</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_4           4</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_12         12</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_13         13</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_CTYPE_14         14</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00220"></a>00220 <span class="comment">/*</span>
<a name="l00221"></a>00221 <span class="comment"> * the ctypes are not globally unique so for</span>
<a name="l00222"></a>00222 <span class="comment"> * translating it to strings we build a table based</span>
<a name="l00223"></a>00223 <span class="comment"> * on objects offsetted by the ctype</span>
<a name="l00224"></a>00224 <span class="comment"> */</span>
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_ctype_values[] = {
<a name="l00227"></a>00227     { 256*RSVP_OBJ_RSVP_HOP+RSVP_CTYPE_IPV4,                 <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00228"></a>00228     { 256*RSVP_OBJ_RSVP_HOP+RSVP_CTYPE_IPV6,                 <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00229"></a>00229     { 256*RSVP_OBJ_RSVP_HOP+RSVP_CTYPE_3,                <span class="stringliteral">&quot;IPv4 plus opt. TLVs&quot;</span> },
<a name="l00230"></a>00230     { 256*RSVP_OBJ_RSVP_HOP+RSVP_CTYPE_4,                <span class="stringliteral">&quot;IPv6 plus opt. TLVs&quot;</span> },
<a name="l00231"></a>00231     { 256*RSVP_OBJ_NOTIFY_REQ+RSVP_CTYPE_IPV4,               <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00232"></a>00232     { 256*RSVP_OBJ_NOTIFY_REQ+RSVP_CTYPE_IPV6,               <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00233"></a>00233     { 256*RSVP_OBJ_CONFIRM+RSVP_CTYPE_IPV4,              <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00234"></a>00234     { 256*RSVP_OBJ_CONFIRM+RSVP_CTYPE_IPV6,              <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00235"></a>00235     { 256*RSVP_OBJ_TIME_VALUES+RSVP_CTYPE_1,                 <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00236"></a>00236     { 256*RSVP_OBJ_FLOWSPEC+RSVP_CTYPE_1,                <span class="stringliteral">&quot;obsolete&quot;</span> },
<a name="l00237"></a>00237     { 256*RSVP_OBJ_FLOWSPEC+RSVP_CTYPE_2,                <span class="stringliteral">&quot;IntServ&quot;</span> },
<a name="l00238"></a>00238     { 256*RSVP_OBJ_SENDER_TSPEC+RSVP_CTYPE_2,                <span class="stringliteral">&quot;IntServ&quot;</span> },
<a name="l00239"></a>00239     { 256*RSVP_OBJ_ADSPEC+RSVP_CTYPE_2,                      <span class="stringliteral">&quot;IntServ&quot;</span> },
<a name="l00240"></a>00240     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_IPV4,               <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00241"></a>00241     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_IPV6,               <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00242"></a>00242     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_3,              <span class="stringliteral">&quot;IPv6 Flow-label&quot;</span> },
<a name="l00243"></a>00243     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_TUNNEL_IPV4,        <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> },
<a name="l00244"></a>00244     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_12,                 <span class="stringliteral">&quot;IPv4 P2MP LSP Tunnel&quot;</span> },
<a name="l00245"></a>00245     { 256*RSVP_OBJ_FILTERSPEC+RSVP_CTYPE_13,                 <span class="stringliteral">&quot;IPv6 P2MP LSP Tunnel&quot;</span> },
<a name="l00246"></a>00246     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_IPV4,              <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00247"></a>00247     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_IPV6,              <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00248"></a>00248     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_TUNNEL_IPV4,           <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> },
<a name="l00249"></a>00249     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_UNI_IPV4,              <span class="stringliteral">&quot;UNI IPv4&quot;</span> },
<a name="l00250"></a>00250     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_13,                    <span class="stringliteral">&quot;IPv4 P2MP LSP Tunnel&quot;</span> },
<a name="l00251"></a>00251     { 256*RSVP_OBJ_SESSION+RSVP_CTYPE_14,                    <span class="stringliteral">&quot;IPv6 P2MP LSP Tunnel&quot;</span> },
<a name="l00252"></a>00252     { 256*RSVP_OBJ_SENDER_TEMPLATE+RSVP_CTYPE_IPV4,          <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00253"></a>00253     { 256*RSVP_OBJ_SENDER_TEMPLATE+RSVP_CTYPE_IPV6,          <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00254"></a>00254     { 256*RSVP_OBJ_SENDER_TEMPLATE+RSVP_CTYPE_TUNNEL_IPV4,   <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> },
<a name="l00255"></a>00255     { 256*RSVP_OBJ_SENDER_TEMPLATE+RSVP_CTYPE_12,            <span class="stringliteral">&quot;IPv4 P2MP LSP Tunnel&quot;</span> },
<a name="l00256"></a>00256     { 256*RSVP_OBJ_SENDER_TEMPLATE+RSVP_CTYPE_13,            <span class="stringliteral">&quot;IPv6 P2MP LSP Tunnel&quot;</span> },
<a name="l00257"></a>00257     { 256*RSVP_OBJ_MESSAGE_ID+RSVP_CTYPE_1,                  <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00258"></a>00258     { 256*RSVP_OBJ_MESSAGE_ID_ACK+RSVP_CTYPE_1,              <span class="stringliteral">&quot;Message id ack&quot;</span> },
<a name="l00259"></a>00259     { 256*RSVP_OBJ_MESSAGE_ID_ACK+RSVP_CTYPE_2,              <span class="stringliteral">&quot;Message id nack&quot;</span> },
<a name="l00260"></a>00260     { 256*RSVP_OBJ_MESSAGE_ID_LIST+RSVP_CTYPE_1,             <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00261"></a>00261     { 256*RSVP_OBJ_STYLE+RSVP_CTYPE_1,                       <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00262"></a>00262     { 256*RSVP_OBJ_HELLO+RSVP_CTYPE_1,                       <span class="stringliteral">&quot;Hello Request&quot;</span> },
<a name="l00263"></a>00263     { 256*RSVP_OBJ_HELLO+RSVP_CTYPE_2,                       <span class="stringliteral">&quot;Hello Ack&quot;</span> },
<a name="l00264"></a>00264     { 256*RSVP_OBJ_LABEL_REQ+RSVP_CTYPE_1,               <span class="stringliteral">&quot;without label range&quot;</span> },
<a name="l00265"></a>00265     { 256*RSVP_OBJ_LABEL_REQ+RSVP_CTYPE_2,               <span class="stringliteral">&quot;with ATM label range&quot;</span> },
<a name="l00266"></a>00266     { 256*RSVP_OBJ_LABEL_REQ+RSVP_CTYPE_3,                   <span class="stringliteral">&quot;with FR label range&quot;</span> },
<a name="l00267"></a>00267     { 256*RSVP_OBJ_LABEL_REQ+RSVP_CTYPE_4,                   <span class="stringliteral">&quot;Generalized Label&quot;</span> },
<a name="l00268"></a>00268     { 256*RSVP_OBJ_LABEL+RSVP_CTYPE_1,                       <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00269"></a>00269     { 256*RSVP_OBJ_LABEL+RSVP_CTYPE_2,                       <span class="stringliteral">&quot;Generalized Label&quot;</span> },
<a name="l00270"></a>00270     { 256*RSVP_OBJ_LABEL+RSVP_CTYPE_3,                       <span class="stringliteral">&quot;Waveband Switching&quot;</span> },
<a name="l00271"></a>00271     { 256*RSVP_OBJ_SUGGESTED_LABEL+RSVP_CTYPE_1,             <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00272"></a>00272     { 256*RSVP_OBJ_SUGGESTED_LABEL+RSVP_CTYPE_2,             <span class="stringliteral">&quot;Generalized Label&quot;</span> },
<a name="l00273"></a>00273     { 256*RSVP_OBJ_SUGGESTED_LABEL+RSVP_CTYPE_3,             <span class="stringliteral">&quot;Waveband Switching&quot;</span> },
<a name="l00274"></a>00274     { 256*RSVP_OBJ_UPSTREAM_LABEL+RSVP_CTYPE_1,              <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00275"></a>00275     { 256*RSVP_OBJ_UPSTREAM_LABEL+RSVP_CTYPE_2,              <span class="stringliteral">&quot;Generalized Label&quot;</span> },
<a name="l00276"></a>00276     { 256*RSVP_OBJ_UPSTREAM_LABEL+RSVP_CTYPE_3,              <span class="stringliteral">&quot;Waveband Switching&quot;</span> },
<a name="l00277"></a>00277     { 256*RSVP_OBJ_RECOVERY_LABEL+RSVP_CTYPE_1,              <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00278"></a>00278     { 256*RSVP_OBJ_RECOVERY_LABEL+RSVP_CTYPE_2,              <span class="stringliteral">&quot;Generalized Label&quot;</span> },
<a name="l00279"></a>00279     { 256*RSVP_OBJ_RECOVERY_LABEL+RSVP_CTYPE_3,              <span class="stringliteral">&quot;Waveband Switching&quot;</span> },
<a name="l00280"></a>00280     { 256*RSVP_OBJ_ERO+RSVP_CTYPE_IPV4,                      <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00281"></a>00281     { 256*RSVP_OBJ_RRO+RSVP_CTYPE_IPV4,                      <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00282"></a>00282     { 256*RSVP_OBJ_ERROR_SPEC+RSVP_CTYPE_IPV4,               <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00283"></a>00283     { 256*RSVP_OBJ_ERROR_SPEC+RSVP_CTYPE_IPV6,               <span class="stringliteral">&quot;IPv6&quot;</span> },
<a name="l00284"></a>00284     { 256*RSVP_OBJ_ERROR_SPEC+RSVP_CTYPE_3,                  <span class="stringliteral">&quot;IPv4 plus opt. TLVs&quot;</span> },
<a name="l00285"></a>00285     { 256*RSVP_OBJ_ERROR_SPEC+RSVP_CTYPE_4,                  <span class="stringliteral">&quot;IPv6 plus opt. TLVs&quot;</span> },
<a name="l00286"></a>00286     { 256*RSVP_OBJ_RESTART_CAPABILITY+RSVP_CTYPE_1,          <span class="stringliteral">&quot;IPv4&quot;</span> },
<a name="l00287"></a>00287     { 256*RSVP_OBJ_SESSION_ATTRIBUTE+RSVP_CTYPE_TUNNEL_IPV4, <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> },
<a name="l00288"></a>00288     { 256*RSVP_OBJ_FASTREROUTE+RSVP_CTYPE_TUNNEL_IPV4,       <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> }, <span class="comment">/* old style*/</span>
<a name="l00289"></a>00289     { 256*RSVP_OBJ_FASTREROUTE+RSVP_CTYPE_1,                 <span class="stringliteral">&quot;1&quot;</span> }, <span class="comment">/* new style */</span>
<a name="l00290"></a>00290     { 256*RSVP_OBJ_DETOUR+RSVP_CTYPE_TUNNEL_IPV4,            <span class="stringliteral">&quot;Tunnel IPv4&quot;</span> },
<a name="l00291"></a>00291     { 256*RSVP_OBJ_PROPERTIES+RSVP_CTYPE_1,                  <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00292"></a>00292     { 256*RSVP_OBJ_ADMIN_STATUS+RSVP_CTYPE_1,                <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00293"></a>00293     { 256*RSVP_OBJ_CLASSTYPE+RSVP_CTYPE_1,                   <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00294"></a>00294     { 256*RSVP_OBJ_CLASSTYPE_OLD+RSVP_CTYPE_1,               <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00295"></a>00295     { 256*RSVP_OBJ_LABEL_SET+RSVP_CTYPE_1,                   <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00296"></a>00296     { 256*RSVP_OBJ_GENERALIZED_UNI+RSVP_CTYPE_1,             <span class="stringliteral">&quot;1&quot;</span> },
<a name="l00297"></a>00297     { 256*RSVP_OBJ_S2L+RSVP_CTYPE_IPV4,                      <span class="stringliteral">&quot;IPv4 sub-LSP&quot;</span> },
<a name="l00298"></a>00298     { 256*RSVP_OBJ_S2L+RSVP_CTYPE_IPV6,                      <span class="stringliteral">&quot;IPv6 sub-LSP&quot;</span> },
<a name="l00299"></a>00299     { 0, NULL}
<a name="l00300"></a>00300 };
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="structrsvp__obj__integrity__t.html">00302</a> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a> {
<a name="l00303"></a>00303     u_int8_t flags;
<a name="l00304"></a>00304     u_int8_t res;
<a name="l00305"></a>00305     u_int8_t key_id[6];
<a name="l00306"></a>00306     u_int8_t sequence[8];
<a name="l00307"></a>00307     u_int8_t digest[16];
<a name="l00308"></a>00308 };
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_integrity_flag_values[] = {
<a name="l00311"></a>00311     { 0x80, <span class="stringliteral">&quot;Handshake&quot;</span> },
<a name="l00312"></a>00312     { 0, NULL}
<a name="l00313"></a>00313 };
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="structrsvp__obj__frr__t.html">00315</a> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a> {
<a name="l00316"></a>00316     u_int8_t setup_prio;
<a name="l00317"></a>00317     u_int8_t hold_prio;
<a name="l00318"></a>00318     u_int8_t hop_limit;
<a name="l00319"></a>00319     u_int8_t flags;
<a name="l00320"></a>00320     u_int8_t bandwidth[4];
<a name="l00321"></a>00321     u_int8_t include_any[4];
<a name="l00322"></a>00322     u_int8_t exclude_any[4];
<a name="l00323"></a>00323     u_int8_t include_all[4];
<a name="l00324"></a>00324 };
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 <span class="preprocessor">#define RSVP_OBJ_XRO_MASK_SUBOBJ(x)   ((x)&amp;0x7f)</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_MASK_LOOSE(x)    ((x)&amp;0x80)</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span>
<a name="l00330"></a>00330 <span class="preprocessor">#define RSVP_OBJ_XRO_RES       0</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_IPV4      1</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_IPV6      2</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_LABEL     3</span>
<a name="l00334"></a>00334 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_ASN       32</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_XRO_MPLS      64</span>
<a name="l00336"></a>00336 <span class="preprocessor"></span>
<a name="l00337"></a>00337 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_xro_values[] = {
<a name="l00338"></a>00338     { RSVP_OBJ_XRO_RES,       <span class="stringliteral">&quot;Reserved&quot;</span> },
<a name="l00339"></a>00339     { RSVP_OBJ_XRO_IPV4,      <span class="stringliteral">&quot;IPv4 prefix&quot;</span> },
<a name="l00340"></a>00340     { RSVP_OBJ_XRO_IPV6,      <span class="stringliteral">&quot;IPv6 prefix&quot;</span> },
<a name="l00341"></a>00341     { RSVP_OBJ_XRO_LABEL,     <span class="stringliteral">&quot;Label&quot;</span> },
<a name="l00342"></a>00342     { RSVP_OBJ_XRO_ASN,       <span class="stringliteral">&quot;Autonomous system number&quot;</span> },
<a name="l00343"></a>00343     { RSVP_OBJ_XRO_MPLS,      <span class="stringliteral">&quot;MPLS label switched path termination&quot;</span> },
<a name="l00344"></a>00344     { 0, NULL}
<a name="l00345"></a>00345 };
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 <span class="comment">/* draft-ietf-mpls-rsvp-lsp-fastreroute-07.txt */</span>
<a name="l00348"></a>00348 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_rro_flag_values[] = {
<a name="l00349"></a>00349     { 0x01,               <span class="stringliteral">&quot;Local protection available&quot;</span> },
<a name="l00350"></a>00350     { 0x02,                   <span class="stringliteral">&quot;Local protection in use&quot;</span> },
<a name="l00351"></a>00351     { 0x04,                   <span class="stringliteral">&quot;Bandwidth protection&quot;</span> },
<a name="l00352"></a>00352     { 0x08,                   <span class="stringliteral">&quot;Node protection&quot;</span> },
<a name="l00353"></a>00353     { 0, NULL}
<a name="l00354"></a>00354 };
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="comment">/* RFC3209 */</span>
<a name="l00357"></a>00357 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_rro_label_flag_values[] = {
<a name="l00358"></a>00358     { 0x01,                   <span class="stringliteral">&quot;Global&quot;</span> },
<a name="l00359"></a>00359     { 0, NULL}
<a name="l00360"></a>00360 };
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_resstyle_values[] = {
<a name="l00363"></a>00363     { 17,                 <span class="stringliteral">&quot;Wildcard Filter&quot;</span> },
<a name="l00364"></a>00364     { 10,                     <span class="stringliteral">&quot;Fixed Filter&quot;</span> },
<a name="l00365"></a>00365     { 18,                     <span class="stringliteral">&quot;Shared Explicit&quot;</span> },
<a name="l00366"></a>00366     { 0, NULL}
<a name="l00367"></a>00367 };
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 <span class="preprocessor">#define RSVP_OBJ_INTSERV_GUARANTEED_SERV 2</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_INTSERV_CONTROLLED_LOAD 5</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span>
<a name="l00372"></a>00372 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_intserv_service_type_values[] = {
<a name="l00373"></a>00373     { 1,                                <span class="stringliteral">&quot;Default/Global Information&quot;</span> },
<a name="l00374"></a>00374     { RSVP_OBJ_INTSERV_GUARANTEED_SERV, <span class="stringliteral">&quot;Guaranteed Service&quot;</span> },
<a name="l00375"></a>00375     { RSVP_OBJ_INTSERV_CONTROLLED_LOAD, <span class="stringliteral">&quot;Controlled Load&quot;</span> },
<a name="l00376"></a>00376     { 0, NULL}
<a name="l00377"></a>00377 };
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_intserv_parameter_id_values[] = {
<a name="l00380"></a>00380     { 4,                     <span class="stringliteral">&quot;IS hop cnt&quot;</span> },
<a name="l00381"></a>00381     { 6,                     <span class="stringliteral">&quot;Path b/w estimate&quot;</span> },
<a name="l00382"></a>00382     { 8,                     <span class="stringliteral">&quot;Minimum path latency&quot;</span> },
<a name="l00383"></a>00383     { 10,                    <span class="stringliteral">&quot;Composed MTU&quot;</span> },
<a name="l00384"></a>00384     { 127,                   <span class="stringliteral">&quot;Token Bucket TSpec&quot;</span> },
<a name="l00385"></a>00385     { 130,                   <span class="stringliteral">&quot;Guaranteed Service RSpec&quot;</span> },
<a name="l00386"></a>00386     { 133,                   <span class="stringliteral">&quot;End-to-end composed value for C&quot;</span> },
<a name="l00387"></a>00387     { 134,                   <span class="stringliteral">&quot;End-to-end composed value for D&quot;</span> },
<a name="l00388"></a>00388     { 135,                   <span class="stringliteral">&quot;Since-last-reshaping point composed C&quot;</span> },
<a name="l00389"></a>00389     { 136,                   <span class="stringliteral">&quot;Since-last-reshaping point composed D&quot;</span> },
<a name="l00390"></a>00390     { 0, NULL}
<a name="l00391"></a>00391 };
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_session_attribute_flag_values[] = {
<a name="l00394"></a>00394     { 0x01,               <span class="stringliteral">&quot;Local Protection&quot;</span> },
<a name="l00395"></a>00395     { 0x02,                   <span class="stringliteral">&quot;Label Recording&quot;</span> },
<a name="l00396"></a>00396     { 0x04,                   <span class="stringliteral">&quot;SE Style&quot;</span> },
<a name="l00397"></a>00397     { 0x08,                   <span class="stringliteral">&quot;Bandwidth protection&quot;</span> }, <span class="comment">/* RFC4090 */</span>
<a name="l00398"></a>00398     { 0x10,                   <span class="stringliteral">&quot;Node protection&quot;</span> },      <span class="comment">/* RFC4090 */</span>
<a name="l00399"></a>00399     { 0, NULL}
<a name="l00400"></a>00400 };
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_prop_tlv_values[] = {
<a name="l00403"></a>00403     { 0x01,                   <span class="stringliteral">&quot;Cos&quot;</span> },
<a name="l00404"></a>00404     { 0x02,                   <span class="stringliteral">&quot;Metric 1&quot;</span> },
<a name="l00405"></a>00405     { 0x04,                   <span class="stringliteral">&quot;Metric 2&quot;</span> },
<a name="l00406"></a>00406     { 0x08,                   <span class="stringliteral">&quot;CCC Status&quot;</span> },
<a name="l00407"></a>00407     { 0x10,                   <span class="stringliteral">&quot;Path Type&quot;</span> },
<a name="l00408"></a>00408     { 0, NULL}
<a name="l00409"></a>00409 };
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="preprocessor">#define RSVP_OBJ_ERROR_SPEC_CODE_ROUTING 24</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_ERROR_SPEC_CODE_NOTIFY  25</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE 28</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE_OLD 125</span>
<a name="l00415"></a>00415 <span class="preprocessor"></span>
<a name="l00416"></a>00416 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_error_code_values[] = {
<a name="l00417"></a>00417     { RSVP_OBJ_ERROR_SPEC_CODE_ROUTING, <span class="stringliteral">&quot;Routing Problem&quot;</span> },
<a name="l00418"></a>00418     { RSVP_OBJ_ERROR_SPEC_CODE_NOTIFY,  <span class="stringliteral">&quot;Notify Error&quot;</span> },
<a name="l00419"></a>00419     { RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE, <span class="stringliteral">&quot;Diffserv TE Error&quot;</span> },
<a name="l00420"></a>00420     { RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE_OLD, <span class="stringliteral">&quot;Diffserv TE Error (Old)&quot;</span> },
<a name="l00421"></a>00421     { 0, NULL}
<a name="l00422"></a>00422 };
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_error_code_routing_values[] = {
<a name="l00425"></a>00425     { 1,                      <span class="stringliteral">&quot;Bad EXPLICIT_ROUTE object&quot;</span> },
<a name="l00426"></a>00426     { 2,                      <span class="stringliteral">&quot;Bad strict node&quot;</span> },
<a name="l00427"></a>00427     { 3,                      <span class="stringliteral">&quot;Bad loose node&quot;</span> },
<a name="l00428"></a>00428     { 4,                      <span class="stringliteral">&quot;Bad initial subobject&quot;</span> },
<a name="l00429"></a>00429     { 5,                      <span class="stringliteral">&quot;No route available toward destination&quot;</span> },
<a name="l00430"></a>00430     { 6,                      <span class="stringliteral">&quot;Unacceptable label value&quot;</span> },
<a name="l00431"></a>00431     { 7,                      <span class="stringliteral">&quot;RRO indicated routing loops&quot;</span> },
<a name="l00432"></a>00432     { 8,                      <span class="stringliteral">&quot;non-RSVP-capable router in the path&quot;</span> },
<a name="l00433"></a>00433     { 9,                      <span class="stringliteral">&quot;MPLS label allocation failure&quot;</span> },
<a name="l00434"></a>00434     { 10,                     <span class="stringliteral">&quot;Unsupported L3PID&quot;</span> },
<a name="l00435"></a>00435     { 0, NULL}
<a name="l00436"></a>00436 };
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_error_code_diffserv_te_values[] = {
<a name="l00439"></a>00439     { 1,                      <span class="stringliteral">&quot;Unexpected CT object&quot;</span> },
<a name="l00440"></a>00440     { 2,                      <span class="stringliteral">&quot;Unsupported CT&quot;</span> },
<a name="l00441"></a>00441     { 3,                      <span class="stringliteral">&quot;Invalid CT value&quot;</span> },
<a name="l00442"></a>00442     { 4,                      <span class="stringliteral">&quot;CT/setup priority do not form a configured TE-Class&quot;</span> },
<a name="l00443"></a>00443     { 5,                      <span class="stringliteral">&quot;CT/holding priority do not form a configured TE-Class&quot;</span> },
<a name="l00444"></a>00444     { 6,                      <span class="stringliteral">&quot;CT/setup priority and CT/holding priority do not form a configured TE-Class&quot;</span> },
<a name="l00445"></a>00445     { 7,                      <span class="stringliteral">&quot;Inconsistency between signaled PSC and signaled CT&quot;</span> }, 
<a name="l00446"></a>00446     { 8,                      <span class="stringliteral">&quot;Inconsistency between signaled PHBs and signaled CT&quot;</span> },
<a name="l00447"></a>00447    { 0, NULL}
<a name="l00448"></a>00448 };
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 <span class="comment">/* rfc3473 / rfc 3471 */</span>
<a name="l00451"></a>00451 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_admin_status_flag_values[] = {
<a name="l00452"></a>00452     { 0x80000000, <span class="stringliteral">&quot;Reflect&quot;</span> },
<a name="l00453"></a>00453     { 0x00000004, <span class="stringliteral">&quot;Testing&quot;</span> },
<a name="l00454"></a>00454     { 0x00000002, <span class="stringliteral">&quot;Admin-down&quot;</span> },
<a name="l00455"></a>00455     { 0x00000001, <span class="stringliteral">&quot;Delete-in-progress&quot;</span> },
<a name="l00456"></a>00456     { 0, NULL}
<a name="l00457"></a>00457 };
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">/* label set actions - rfc3471 */</span>
<a name="l00460"></a>00460 <span class="preprocessor">#define LABEL_SET_INCLUSIVE_LIST  0</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span><span class="preprocessor">#define LABEL_SET_EXCLUSIVE_LIST  1</span>
<a name="l00462"></a>00462 <span class="preprocessor"></span><span class="preprocessor">#define LABEL_SET_INCLUSIVE_RANGE 2</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span><span class="preprocessor">#define LABEL_SET_EXCLUSIVE_RANGE 3</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span>
<a name="l00465"></a>00465 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_label_set_action_values[] = {
<a name="l00466"></a>00466     { LABEL_SET_INCLUSIVE_LIST, <span class="stringliteral">&quot;Inclusive list&quot;</span> },
<a name="l00467"></a>00467     { LABEL_SET_EXCLUSIVE_LIST, <span class="stringliteral">&quot;Exclusive list&quot;</span> },
<a name="l00468"></a>00468     { LABEL_SET_INCLUSIVE_RANGE, <span class="stringliteral">&quot;Inclusive range&quot;</span> },
<a name="l00469"></a>00469     { LABEL_SET_EXCLUSIVE_RANGE, <span class="stringliteral">&quot;Exclusive range&quot;</span> },
<a name="l00470"></a>00470     { 0, NULL}
<a name="l00471"></a>00471 };
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="comment">/* OIF RSVP extensions UNI 1.0 Signaling, release 2 */</span>
<a name="l00474"></a>00474 <span class="preprocessor">#define RSVP_GEN_UNI_SUBOBJ_SOURCE_TNA_ADDRESS      1</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_GEN_UNI_SUBOBJ_DESTINATION_TNA_ADDRESS 2</span>
<a name="l00476"></a>00476 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_GEN_UNI_SUBOBJ_DIVERSITY           3</span>
<a name="l00477"></a>00477 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_GEN_UNI_SUBOBJ_EGRESS_LABEL            4</span>
<a name="l00478"></a>00478 <span class="preprocessor"></span><span class="preprocessor">#define RSVP_GEN_UNI_SUBOBJ_SERVICE_LEVEL           5</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>
<a name="l00480"></a>00480 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtok.html">tok</a> rsvp_obj_generalized_uni_values[] = {
<a name="l00481"></a>00481     { RSVP_GEN_UNI_SUBOBJ_SOURCE_TNA_ADDRESS, <span class="stringliteral">&quot;Source TNA address&quot;</span> },
<a name="l00482"></a>00482     { RSVP_GEN_UNI_SUBOBJ_DESTINATION_TNA_ADDRESS, <span class="stringliteral">&quot;Destination TNA address&quot;</span> },
<a name="l00483"></a>00483     { RSVP_GEN_UNI_SUBOBJ_DIVERSITY, <span class="stringliteral">&quot;Diversity&quot;</span> },
<a name="l00484"></a>00484     { RSVP_GEN_UNI_SUBOBJ_EGRESS_LABEL, <span class="stringliteral">&quot;Egress label&quot;</span> },
<a name="l00485"></a>00485     { RSVP_GEN_UNI_SUBOBJ_SERVICE_LEVEL, <span class="stringliteral">&quot;Service level&quot;</span> },
<a name="l00486"></a>00486     { 0, NULL}
<a name="l00487"></a>00487 };
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 <span class="keyword">static</span> <span class="keywordtype">int</span> rsvp_intserv_print(<span class="keyword">const</span> u_char *, u_short);
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="comment">/* </span>
<a name="l00492"></a>00492 <span class="comment"> * this is a dissector for all the intserv defined</span>
<a name="l00493"></a>00493 <span class="comment"> * specs as defined per rfc2215</span>
<a name="l00494"></a>00494 <span class="comment"> * it is called from various rsvp objects;</span>
<a name="l00495"></a>00495 <span class="comment"> * returns the amount of bytes being processed</span>
<a name="l00496"></a>00496 <span class="comment"> */</span>
<a name="l00497"></a>00497 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00498"></a>00498 rsvp_intserv_print(<span class="keyword">const</span> u_char *tptr, u_short obj_tlen) {
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="keywordtype">int</span> parameter_id,parameter_length;
<a name="l00501"></a>00501     <span class="keyword">union </span>{
<a name="l00502"></a>00502     <span class="keywordtype">float</span> f;
<a name="l00503"></a>00503     u_int32_t i;
<a name="l00504"></a>00504     } bw;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l00507"></a>00507         <span class="keywordflow">return</span> 0;
<a name="l00508"></a>00508     parameter_id = *(tptr);
<a name="l00509"></a>00509     parameter_length = EXTRACT_16BITS(tptr+2)&lt;&lt;2; <span class="comment">/* convert wordcount to bytecount */</span>
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     printf(<span class="stringliteral">&quot;\n\t      Parameter ID: %s (%u), length: %u, Flags: [0x%02x]&quot;</span>,
<a name="l00512"></a>00512            tok2str(rsvp_intserv_parameter_id_values,<span class="stringliteral">&quot;unknown&quot;</span>,parameter_id),
<a name="l00513"></a>00513            parameter_id,
<a name="l00514"></a>00514            parameter_length,
<a name="l00515"></a>00515            *(tptr+1));
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="keywordflow">if</span> (obj_tlen &lt; parameter_length+4)
<a name="l00518"></a>00518         <span class="keywordflow">return</span> 0;
<a name="l00519"></a>00519     <span class="keywordflow">switch</span>(parameter_id) { <span class="comment">/* parameter_id */</span>
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="keywordflow">case</span> 4:
<a name="l00522"></a>00522        <span class="comment">/*</span>
<a name="l00523"></a>00523 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00524"></a>00524 <span class="comment">        * |    4 (e)      |    (f)        |           1 (g)               |</span>
<a name="l00525"></a>00525 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00526"></a>00526 <span class="comment">        * |        IS hop cnt (32-bit unsigned integer)                   |</span>
<a name="l00527"></a>00527 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00528"></a>00528 <span class="comment">        */</span>
<a name="l00529"></a>00529         <span class="keywordflow">if</span> (parameter_length == 4)
<a name="l00530"></a>00530             printf(<span class="stringliteral">&quot;\n\t\tIS hop count: %u&quot;</span>, EXTRACT_32BITS(tptr+4));
<a name="l00531"></a>00531         <span class="keywordflow">break</span>;
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     <span class="keywordflow">case</span> 6:
<a name="l00534"></a>00534        <span class="comment">/*</span>
<a name="l00535"></a>00535 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00536"></a>00536 <span class="comment">        * |    6 (h)      |    (i)        |           1 (j)               |</span>
<a name="l00537"></a>00537 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00538"></a>00538 <span class="comment">        * |  Path b/w estimate  (32-bit IEEE floating point number)       |</span>
<a name="l00539"></a>00539 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00540"></a>00540 <span class="comment">        */</span>
<a name="l00541"></a>00541         <span class="keywordflow">if</span> (parameter_length == 4) {
<a name="l00542"></a>00542             bw.i = EXTRACT_32BITS(tptr+4);
<a name="l00543"></a>00543             printf(<span class="stringliteral">&quot;\n\t\tPath b/w estimate: %.10g Mbps&quot;</span>, bw.f/125000);
<a name="l00544"></a>00544         }
<a name="l00545"></a>00545         <span class="keywordflow">break</span>;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keywordflow">case</span> 8:
<a name="l00548"></a>00548        <span class="comment">/*</span>
<a name="l00549"></a>00549 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00550"></a>00550 <span class="comment">        * |     8 (k)     |    (l)        |           1 (m)               |</span>
<a name="l00551"></a>00551 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00552"></a>00552 <span class="comment">        * |        Minimum path latency (32-bit integer)                  |</span>
<a name="l00553"></a>00553 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00554"></a>00554 <span class="comment">        */</span>
<a name="l00555"></a>00555         <span class="keywordflow">if</span> (parameter_length == 4) {
<a name="l00556"></a>00556             printf(<span class="stringliteral">&quot;\n\t\tMinimum path latency: &quot;</span>);
<a name="l00557"></a>00557             <span class="keywordflow">if</span> (EXTRACT_32BITS(tptr+4) == 0xffffffff)
<a name="l00558"></a>00558                 printf(<span class="stringliteral">&quot;don&#39;t care&quot;</span>);
<a name="l00559"></a>00559             <span class="keywordflow">else</span>
<a name="l00560"></a>00560                 printf(<span class="stringliteral">&quot;%u&quot;</span>, EXTRACT_32BITS(tptr+4));
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562         <span class="keywordflow">break</span>;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     <span class="keywordflow">case</span> 10:
<a name="l00565"></a>00565 
<a name="l00566"></a>00566        <span class="comment">/*</span>
<a name="l00567"></a>00567 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00568"></a>00568 <span class="comment">        * |     10 (n)    |      (o)      |           1 (p)               |</span>
<a name="l00569"></a>00569 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00570"></a>00570 <span class="comment">        * |      Composed MTU (32-bit unsigned integer)                   |</span>
<a name="l00571"></a>00571 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00572"></a>00572 <span class="comment">        */</span>
<a name="l00573"></a>00573         <span class="keywordflow">if</span> (parameter_length == 4)
<a name="l00574"></a>00574             printf(<span class="stringliteral">&quot;\n\t\tComposed MTU: %u bytes&quot;</span>, EXTRACT_32BITS(tptr+4));
<a name="l00575"></a>00575         <span class="keywordflow">break</span>;
<a name="l00576"></a>00576     <span class="keywordflow">case</span> 127:
<a name="l00577"></a>00577        <span class="comment">/* </span>
<a name="l00578"></a>00578 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00579"></a>00579 <span class="comment">        * |   127 (e)     |    0 (f)      |             5 (g)             |</span>
<a name="l00580"></a>00580 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00581"></a>00581 <span class="comment">        * |  Token Bucket Rate [r] (32-bit IEEE floating point number)    |</span>
<a name="l00582"></a>00582 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00583"></a>00583 <span class="comment">        * |  Token Bucket Size [b] (32-bit IEEE floating point number)    |</span>
<a name="l00584"></a>00584 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00585"></a>00585 <span class="comment">        * |  Peak Data Rate [p] (32-bit IEEE floating point number)       |</span>
<a name="l00586"></a>00586 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00587"></a>00587 <span class="comment">        * |  Minimum Policed Unit [m] (32-bit integer)                    |</span>
<a name="l00588"></a>00588 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00589"></a>00589 <span class="comment">        * |  Maximum Packet Size [M]  (32-bit integer)                    |</span>
<a name="l00590"></a>00590 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00591"></a>00591 <span class="comment">        */</span>
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         <span class="keywordflow">if</span> (parameter_length == 20) {
<a name="l00594"></a>00594             bw.i = EXTRACT_32BITS(tptr+4);
<a name="l00595"></a>00595             printf(<span class="stringliteral">&quot;\n\t\tToken Bucket Rate: %.10g Mbps&quot;</span>, bw.f/125000);
<a name="l00596"></a>00596             bw.i = EXTRACT_32BITS(tptr+8);
<a name="l00597"></a>00597             printf(<span class="stringliteral">&quot;\n\t\tToken Bucket Size: %.10g bytes&quot;</span>, bw.f);
<a name="l00598"></a>00598             bw.i = EXTRACT_32BITS(tptr+12);
<a name="l00599"></a>00599             printf(<span class="stringliteral">&quot;\n\t\tPeak Data Rate: %.10g Mbps&quot;</span>, bw.f/125000);
<a name="l00600"></a>00600             printf(<span class="stringliteral">&quot;\n\t\tMinimum Policed Unit: %u bytes&quot;</span>, EXTRACT_32BITS(tptr+16));
<a name="l00601"></a>00601             printf(<span class="stringliteral">&quot;\n\t\tMaximum Packet Size: %u bytes&quot;</span>, EXTRACT_32BITS(tptr+20));
<a name="l00602"></a>00602         }
<a name="l00603"></a>00603         <span class="keywordflow">break</span>;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     <span class="keywordflow">case</span> 130:
<a name="l00606"></a>00606        <span class="comment">/* </span>
<a name="l00607"></a>00607 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00608"></a>00608 <span class="comment">        * |     130 (h)   |    0 (i)      |            2 (j)              |</span>
<a name="l00609"></a>00609 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00610"></a>00610 <span class="comment">        * |  Rate [R]  (32-bit IEEE floating point number)                |</span>
<a name="l00611"></a>00611 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00612"></a>00612 <span class="comment">        * |  Slack Term [S]  (32-bit integer)                             |</span>
<a name="l00613"></a>00613 <span class="comment">        * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<a name="l00614"></a>00614 <span class="comment">        */</span>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616         <span class="keywordflow">if</span> (parameter_length == 8) {
<a name="l00617"></a>00617             bw.i = EXTRACT_32BITS(tptr+4);
<a name="l00618"></a>00618             printf(<span class="stringliteral">&quot;\n\t\tRate: %.10g Mbps&quot;</span>, bw.f/125000);
<a name="l00619"></a>00619             printf(<span class="stringliteral">&quot;\n\t\tSlack Term: %u&quot;</span>, EXTRACT_32BITS(tptr+8));
<a name="l00620"></a>00620         }
<a name="l00621"></a>00621         <span class="keywordflow">break</span>;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623     <span class="keywordflow">case</span> 133:
<a name="l00624"></a>00624     <span class="keywordflow">case</span> 134:
<a name="l00625"></a>00625     <span class="keywordflow">case</span> 135:
<a name="l00626"></a>00626     <span class="keywordflow">case</span> 136:
<a name="l00627"></a>00627         <span class="keywordflow">if</span> (parameter_length == 4)
<a name="l00628"></a>00628             printf(<span class="stringliteral">&quot;\n\t\tValue: %u&quot;</span>, EXTRACT_32BITS(tptr+4));
<a name="l00629"></a>00629         <span class="keywordflow">break</span>;
<a name="l00630"></a>00630 
<a name="l00631"></a>00631     <span class="keywordflow">default</span>:
<a name="l00632"></a>00632         <span class="keywordflow">if</span> (vflag &lt;= 1)
<a name="l00633"></a>00633             print_unknown_data(tptr+4,<span class="stringliteral">&quot;\n\t\t&quot;</span>,parameter_length);
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635     <span class="keywordflow">return</span> (parameter_length+4); <span class="comment">/* header length 4 bytes */</span>
<a name="l00636"></a>00636 }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00639"></a>00639 rsvp_obj_print (<span class="keyword">const</span> u_char *pptr
<a name="l00640"></a>00640 #ifndef HAVE_LIBCRYPTO
<a name="l00641"></a>00641 _U_
<a name="l00642"></a>00642 #endif
<a name="l00643"></a>00643 , u_int plen
<a name="l00644"></a>00644 #ifndef HAVE_LIBCRYPTO
<a name="l00645"></a>00645 _U_
<a name="l00646"></a>00646 #endif
<a name="l00647"></a>00647 , <span class="keyword">const</span> u_char *tptr,
<a name="l00648"></a>00648                 <span class="keyword">const</span> <span class="keywordtype">char</span> *ident, u_int tlen) {
<a name="l00649"></a>00649 
<a name="l00650"></a>00650     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__object__header.html">rsvp_object_header</a> *rsvp_obj_header;
<a name="l00651"></a>00651     <span class="keyword">const</span> u_char *obj_tptr;
<a name="l00652"></a>00652     <span class="keyword">union </span>{
<a name="l00653"></a>00653         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a> *rsvp_obj_integrity;
<a name="l00654"></a>00654         <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a> *rsvp_obj_frr;
<a name="l00655"></a>00655     } obj_ptr;
<a name="l00656"></a>00656 
<a name="l00657"></a>00657     u_short rsvp_obj_len,rsvp_obj_ctype,obj_tlen,intserv_serv_tlen;
<a name="l00658"></a>00658     <span class="keywordtype">int</span> hexdump,processed,padbytes,error_code,error_value,i,sigcheck;
<a name="l00659"></a>00659     <span class="keyword">union </span>{
<a name="l00660"></a>00660     <span class="keywordtype">float</span> f;
<a name="l00661"></a>00661     u_int32_t i;
<a name="l00662"></a>00662     } bw;
<a name="l00663"></a>00663     u_int8_t namelen;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     u_int action, subchannel;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667     <span class="keywordflow">while</span>(tlen&gt;=<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>)) {
<a name="l00668"></a>00668         <span class="comment">/* did we capture enough for fully decoding the object header ? */</span>
<a name="l00669"></a>00669         <span class="keywordflow">if</span> (!TTEST2(*tptr, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>)))
<a name="l00670"></a>00670             <span class="keywordflow">goto</span> trunc;
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         rsvp_obj_header = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__object__header.html">rsvp_object_header</a> *)tptr;
<a name="l00673"></a>00673         rsvp_obj_len=EXTRACT_16BITS(rsvp_obj_header-&gt;length);
<a name="l00674"></a>00674         rsvp_obj_ctype=rsvp_obj_header-&gt;ctype;
<a name="l00675"></a>00675 
<a name="l00676"></a>00676         <span class="keywordflow">if</span>(rsvp_obj_len % 4) {
<a name="l00677"></a>00677             printf(<span class="stringliteral">&quot;%sERROR: object header size %u not a multiple of 4&quot;</span>, ident, rsvp_obj_len);
<a name="l00678"></a>00678             <span class="keywordflow">return</span> -1;
<a name="l00679"></a>00679         }
<a name="l00680"></a>00680         <span class="keywordflow">if</span>(rsvp_obj_len &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>)) {
<a name="l00681"></a>00681             printf(<span class="stringliteral">&quot;%sERROR: object header too short %u &lt; %lu&quot;</span>, ident, rsvp_obj_len,
<a name="l00682"></a>00682                    (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>));
<a name="l00683"></a>00683             <span class="keywordflow">return</span> -1;
<a name="l00684"></a>00684         }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686         printf(<span class="stringliteral">&quot;%s%s Object (%u) Flags: [%s&quot;</span>,
<a name="l00687"></a>00687                ident,
<a name="l00688"></a>00688                tok2str(rsvp_obj_values,
<a name="l00689"></a>00689                        <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l00690"></a>00690                        rsvp_obj_header-&gt;class_num),
<a name="l00691"></a>00691                rsvp_obj_header-&gt;class_num,
<a name="l00692"></a>00692                ((rsvp_obj_header-&gt;class_num)&amp;0x80) ? <span class="stringliteral">&quot;ignore&quot;</span> : <span class="stringliteral">&quot;reject&quot;</span>);
<a name="l00693"></a>00693 
<a name="l00694"></a>00694         <span class="keywordflow">if</span> (rsvp_obj_header-&gt;class_num &gt; 128)
<a name="l00695"></a>00695             printf(<span class="stringliteral">&quot; %s&quot;</span>,
<a name="l00696"></a>00696                    ((rsvp_obj_header-&gt;class_num)&amp;0x40) ? <span class="stringliteral">&quot;and forward&quot;</span> : <span class="stringliteral">&quot;silently&quot;</span>);
<a name="l00697"></a>00697 
<a name="l00698"></a>00698         printf(<span class="stringliteral">&quot; if unknown], Class-Type: %s (%u), length: %u&quot;</span>,
<a name="l00699"></a>00699                tok2str(rsvp_ctype_values,
<a name="l00700"></a>00700                        <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l00701"></a>00701                        ((rsvp_obj_header-&gt;class_num)&lt;&lt;8)+rsvp_obj_ctype),
<a name="l00702"></a>00702                rsvp_obj_ctype,
<a name="l00703"></a>00703                rsvp_obj_len);
<a name="l00704"></a>00704     
<a name="l00705"></a>00705         <span class="keywordflow">if</span>(tlen &lt; rsvp_obj_len) {
<a name="l00706"></a>00706             printf(<span class="stringliteral">&quot;%sERROR: object goes past end of objects TLV&quot;</span>, ident);
<a name="l00707"></a>00707             <span class="keywordflow">return</span> -1;
<a name="l00708"></a>00708         }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710         obj_tptr=tptr+<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>);
<a name="l00711"></a>00711         obj_tlen=rsvp_obj_len-<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713         <span class="comment">/* did we capture enough for fully decoding the object ? */</span>
<a name="l00714"></a>00714         <span class="keywordflow">if</span> (!TTEST2(*tptr, rsvp_obj_len))
<a name="l00715"></a>00715             <span class="keywordflow">return</span> -1;
<a name="l00716"></a>00716         hexdump=FALSE;
<a name="l00717"></a>00717 
<a name="l00718"></a>00718         <span class="keywordflow">switch</span>(rsvp_obj_header-&gt;class_num) {
<a name="l00719"></a>00719         <span class="keywordflow">case</span> RSVP_OBJ_SESSION:
<a name="l00720"></a>00720             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00721"></a>00721             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l00722"></a>00722                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l00723"></a>00723                     <span class="keywordflow">return</span> -1;
<a name="l00724"></a>00724                 printf(<span class="stringliteral">&quot;%s  IPv4 DestAddress: %s, Protocol ID: 0x%02x&quot;</span>,
<a name="l00725"></a>00725                        ident,
<a name="l00726"></a>00726                        ipaddr_string(obj_tptr),
<a name="l00727"></a>00727                        *(obj_tptr+<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr)));
<a name="l00728"></a>00728                 printf(<span class="stringliteral">&quot;%s  Flags: [0x%02x], DestPort %u&quot;</span>,
<a name="l00729"></a>00729                        ident,
<a name="l00730"></a>00730                        *(obj_tptr+5),
<a name="l00731"></a>00731                        EXTRACT_16BITS(obj_tptr+6));
<a name="l00732"></a>00732                 obj_tlen-=8;
<a name="l00733"></a>00733                 obj_tptr+=8;                
<a name="l00734"></a>00734                 <span class="keywordflow">break</span>;
<a name="l00735"></a>00735 <span class="preprocessor">#ifdef INET6</span>
<a name="l00736"></a>00736 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l00737"></a>00737                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l00738"></a>00738                     <span class="keywordflow">return</span> -1;
<a name="l00739"></a>00739                 printf(<span class="stringliteral">&quot;%s  IPv6 DestAddress: %s, Protocol ID: 0x%02x&quot;</span>,
<a name="l00740"></a>00740                        ident,
<a name="l00741"></a>00741                        ip6addr_string(obj_tptr),
<a name="l00742"></a>00742                        *(obj_tptr+<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr)));
<a name="l00743"></a>00743                 printf(<span class="stringliteral">&quot;%s  Flags: [0x%02x], DestPort %u&quot;</span>,
<a name="l00744"></a>00744                        ident,
<a name="l00745"></a>00745                        *(obj_tptr+<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr)+1),
<a name="l00746"></a>00746                        EXTRACT_16BITS(obj_tptr+<span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr)+2));
<a name="l00747"></a>00747                 obj_tlen-=20;
<a name="l00748"></a>00748                 obj_tptr+=20;                
<a name="l00749"></a>00749                 <span class="keywordflow">break</span>;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV6:
<a name="l00752"></a>00752                 <span class="keywordflow">if</span> (obj_tlen &lt; 36)
<a name="l00753"></a>00753                     <span class="keywordflow">return</span> -1;
<a name="l00754"></a>00754                 printf(<span class="stringliteral">&quot;%s  IPv6 Tunnel EndPoint: %s, Tunnel ID: 0x%04x, Extended Tunnel ID: %s&quot;</span>,
<a name="l00755"></a>00755                        ident,
<a name="l00756"></a>00756                        ip6addr_string(obj_tptr),
<a name="l00757"></a>00757                        EXTRACT_16BITS(obj_tptr+18),
<a name="l00758"></a>00758                        ip6addr_string(obj_tptr+20));
<a name="l00759"></a>00759                 obj_tlen-=36;
<a name="l00760"></a>00760                 obj_tptr+=36;                
<a name="l00761"></a>00761                 <span class="keywordflow">break</span>;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763             <span class="keywordflow">case</span> RSVP_CTYPE_14: <span class="comment">/* IPv6 p2mp LSP Tunnel */</span>
<a name="l00764"></a>00764                 <span class="keywordflow">if</span> (obj_tlen &lt; 26)
<a name="l00765"></a>00765                     <span class="keywordflow">return</span> -1;
<a name="l00766"></a>00766                 printf(<span class="stringliteral">&quot;%s  IPv6 P2MP LSP ID: 0x%08x, Tunnel ID: 0x%04x, Extended Tunnel ID: %s&quot;</span>,
<a name="l00767"></a>00767                        ident,
<a name="l00768"></a>00768                        EXTRACT_32BITS(obj_tptr),
<a name="l00769"></a>00769                        EXTRACT_16BITS(obj_tptr+6),
<a name="l00770"></a>00770                        ip6addr_string(obj_tptr+8));
<a name="l00771"></a>00771                 obj_tlen-=26;
<a name="l00772"></a>00772                 obj_tptr+=26;                
<a name="l00773"></a>00773                 <span class="keywordflow">break</span>;
<a name="l00774"></a>00774 <span class="preprocessor">#endif</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_13: <span class="comment">/* IPv4 p2mp LSP Tunnel */</span>
<a name="l00776"></a>00776                 <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l00777"></a>00777                     <span class="keywordflow">return</span> -1;
<a name="l00778"></a>00778                 printf(<span class="stringliteral">&quot;%s  IPv4 P2MP LSP ID: %s, Tunnel ID: 0x%04x, Extended Tunnel ID: %s&quot;</span>,
<a name="l00779"></a>00779                        ident,
<a name="l00780"></a>00780                        ipaddr_string(obj_tptr),
<a name="l00781"></a>00781                        EXTRACT_16BITS(obj_tptr+6),
<a name="l00782"></a>00782                        ipaddr_string(obj_tptr+8));
<a name="l00783"></a>00783                 obj_tlen-=12;
<a name="l00784"></a>00784                 obj_tptr+=12;                
<a name="l00785"></a>00785                 <span class="keywordflow">break</span>;
<a name="l00786"></a>00786             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4:
<a name="l00787"></a>00787             <span class="keywordflow">case</span> RSVP_CTYPE_UNI_IPV4:
<a name="l00788"></a>00788                 <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l00789"></a>00789                     <span class="keywordflow">return</span> -1;
<a name="l00790"></a>00790                 printf(<span class="stringliteral">&quot;%s  IPv4 Tunnel EndPoint: %s, Tunnel ID: 0x%04x, Extended Tunnel ID: %s&quot;</span>,
<a name="l00791"></a>00791                        ident,
<a name="l00792"></a>00792                        ipaddr_string(obj_tptr),
<a name="l00793"></a>00793                        EXTRACT_16BITS(obj_tptr+6),
<a name="l00794"></a>00794                        ipaddr_string(obj_tptr+8));
<a name="l00795"></a>00795                 obj_tlen-=12;
<a name="l00796"></a>00796                 obj_tptr+=12;                
<a name="l00797"></a>00797                 <span class="keywordflow">break</span>;
<a name="l00798"></a>00798             <span class="keywordflow">default</span>:
<a name="l00799"></a>00799                 hexdump=TRUE;
<a name="l00800"></a>00800             }
<a name="l00801"></a>00801             <span class="keywordflow">break</span>;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         <span class="keywordflow">case</span> RSVP_OBJ_CONFIRM:
<a name="l00804"></a>00804             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00805"></a>00805             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l00806"></a>00806                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr))
<a name="l00807"></a>00807                     <span class="keywordflow">return</span> -1;
<a name="l00808"></a>00808                 printf(<span class="stringliteral">&quot;%s  IPv4 Receiver Address: %s&quot;</span>,
<a name="l00809"></a>00809                        ident,
<a name="l00810"></a>00810                        ipaddr_string(obj_tptr));
<a name="l00811"></a>00811                 obj_tlen-=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);
<a name="l00812"></a>00812                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);                
<a name="l00813"></a>00813                 <span class="keywordflow">break</span>;
<a name="l00814"></a>00814 <span class="preprocessor">#ifdef INET6</span>
<a name="l00815"></a>00815 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l00816"></a>00816                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr))
<a name="l00817"></a>00817                     <span class="keywordflow">return</span> -1;
<a name="l00818"></a>00818                 printf(<span class="stringliteral">&quot;%s  IPv6 Receiver Address: %s&quot;</span>,
<a name="l00819"></a>00819                        ident,
<a name="l00820"></a>00820                        ip6addr_string(obj_tptr));
<a name="l00821"></a>00821                 obj_tlen-=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in6_addr);
<a name="l00822"></a>00822                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in6_addr);                
<a name="l00823"></a>00823                 <span class="keywordflow">break</span>;
<a name="l00824"></a>00824 <span class="preprocessor">#endif</span>
<a name="l00825"></a>00825 <span class="preprocessor"></span>            <span class="keywordflow">default</span>:
<a name="l00826"></a>00826                 hexdump=TRUE;
<a name="l00827"></a>00827             }
<a name="l00828"></a>00828             <span class="keywordflow">break</span>;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830         <span class="keywordflow">case</span> RSVP_OBJ_NOTIFY_REQ:
<a name="l00831"></a>00831             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00832"></a>00832             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l00833"></a>00833                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in_addr))
<a name="l00834"></a>00834                     <span class="keywordflow">return</span> -1;
<a name="l00835"></a>00835                 printf(<span class="stringliteral">&quot;%s  IPv4 Notify Node Address: %s&quot;</span>,
<a name="l00836"></a>00836                        ident,
<a name="l00837"></a>00837                        ipaddr_string(obj_tptr));
<a name="l00838"></a>00838                 obj_tlen-=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);
<a name="l00839"></a>00839                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);                
<a name="l00840"></a>00840                 <span class="keywordflow">break</span>;
<a name="l00841"></a>00841 <span class="preprocessor">#ifdef INET6</span>
<a name="l00842"></a>00842 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l00843"></a>00843                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> in6_addr))
<a name="l00844"></a>00844                     <span class="keywordflow">return</span>-1;
<a name="l00845"></a>00845                 printf(<span class="stringliteral">&quot;%s  IPv6 Notify Node Address: %s&quot;</span>,
<a name="l00846"></a>00846                        ident,
<a name="l00847"></a>00847                        ip6addr_string(obj_tptr));
<a name="l00848"></a>00848                 obj_tlen-=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in6_addr);
<a name="l00849"></a>00849                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span>in6_addr);                
<a name="l00850"></a>00850                 <span class="keywordflow">break</span>;
<a name="l00851"></a>00851 <span class="preprocessor">#endif</span>
<a name="l00852"></a>00852 <span class="preprocessor"></span>            <span class="keywordflow">default</span>:
<a name="l00853"></a>00853                 hexdump=TRUE;
<a name="l00854"></a>00854             }
<a name="l00855"></a>00855             <span class="keywordflow">break</span>;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="keywordflow">case</span> RSVP_OBJ_SUGGESTED_LABEL: <span class="comment">/* fall through */</span>
<a name="l00858"></a>00858         <span class="keywordflow">case</span> RSVP_OBJ_UPSTREAM_LABEL:  <span class="comment">/* fall through */</span>
<a name="l00859"></a>00859         <span class="keywordflow">case</span> RSVP_OBJ_RECOVERY_LABEL:  <span class="comment">/* fall through */</span>
<a name="l00860"></a>00860         <span class="keywordflow">case</span> RSVP_OBJ_LABEL:
<a name="l00861"></a>00861             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00862"></a>00862             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l00863"></a>00863                 <span class="keywordflow">while</span>(obj_tlen &gt;= 4 ) {
<a name="l00864"></a>00864                     printf(<span class="stringliteral">&quot;%s  Label: %u&quot;</span>, ident, EXTRACT_32BITS(obj_tptr));
<a name="l00865"></a>00865                     obj_tlen-=4;
<a name="l00866"></a>00866                     obj_tptr+=4;
<a name="l00867"></a>00867                 }
<a name="l00868"></a>00868                 <span class="keywordflow">break</span>;
<a name="l00869"></a>00869             <span class="keywordflow">case</span> RSVP_CTYPE_2:
<a name="l00870"></a>00870                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l00871"></a>00871                     <span class="keywordflow">return</span>-1;
<a name="l00872"></a>00872                 printf(<span class="stringliteral">&quot;%s  Generalized Label: %u&quot;</span>,
<a name="l00873"></a>00873                        ident,
<a name="l00874"></a>00874                        EXTRACT_32BITS(obj_tptr));
<a name="l00875"></a>00875                 obj_tlen-=4;
<a name="l00876"></a>00876                 obj_tptr+=4;
<a name="l00877"></a>00877                 <span class="keywordflow">break</span>;
<a name="l00878"></a>00878             <span class="keywordflow">case</span> RSVP_CTYPE_3:
<a name="l00879"></a>00879                 <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l00880"></a>00880                     <span class="keywordflow">return</span>-1;
<a name="l00881"></a>00881                 printf(<span class="stringliteral">&quot;%s  Waveband ID: %u%s  Start Label: %u, Stop Label: %u&quot;</span>,
<a name="l00882"></a>00882                        ident,
<a name="l00883"></a>00883                        EXTRACT_32BITS(obj_tptr),
<a name="l00884"></a>00884                        ident,
<a name="l00885"></a>00885                        EXTRACT_32BITS(obj_tptr+4),
<a name="l00886"></a>00886                        EXTRACT_32BITS(obj_tptr+8));
<a name="l00887"></a>00887                 obj_tlen-=12;
<a name="l00888"></a>00888                 obj_tptr+=12;
<a name="l00889"></a>00889                 <span class="keywordflow">break</span>;
<a name="l00890"></a>00890             <span class="keywordflow">default</span>:
<a name="l00891"></a>00891                 hexdump=TRUE;
<a name="l00892"></a>00892             }
<a name="l00893"></a>00893             <span class="keywordflow">break</span>;
<a name="l00894"></a>00894 
<a name="l00895"></a>00895         <span class="keywordflow">case</span> RSVP_OBJ_STYLE:
<a name="l00896"></a>00896             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00897"></a>00897             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l00898"></a>00898                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l00899"></a>00899                     <span class="keywordflow">return</span>-1;
<a name="l00900"></a>00900                 printf(<span class="stringliteral">&quot;%s  Reservation Style: %s, Flags: [0x%02x]&quot;</span>,
<a name="l00901"></a>00901                        ident,
<a name="l00902"></a>00902                        tok2str(rsvp_resstyle_values,
<a name="l00903"></a>00903                                <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l00904"></a>00904                                EXTRACT_24BITS(obj_tptr+1)),
<a name="l00905"></a>00905                        *(obj_tptr));
<a name="l00906"></a>00906                 obj_tlen-=4;
<a name="l00907"></a>00907                 obj_tptr+=4;
<a name="l00908"></a>00908                 <span class="keywordflow">break</span>;
<a name="l00909"></a>00909             <span class="keywordflow">default</span>:
<a name="l00910"></a>00910                 hexdump=TRUE;
<a name="l00911"></a>00911             }
<a name="l00912"></a>00912             <span class="keywordflow">break</span>;
<a name="l00913"></a>00913 
<a name="l00914"></a>00914         <span class="keywordflow">case</span> RSVP_OBJ_SENDER_TEMPLATE:
<a name="l00915"></a>00915             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00916"></a>00916             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l00917"></a>00917                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l00918"></a>00918                     <span class="keywordflow">return</span>-1;
<a name="l00919"></a>00919                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, Source Port: %u&quot;</span>,
<a name="l00920"></a>00920                        ident,
<a name="l00921"></a>00921                        ipaddr_string(obj_tptr),
<a name="l00922"></a>00922                        EXTRACT_16BITS(obj_tptr+6));
<a name="l00923"></a>00923                 obj_tlen-=8;
<a name="l00924"></a>00924                 obj_tptr+=8;
<a name="l00925"></a>00925                 <span class="keywordflow">break</span>;
<a name="l00926"></a>00926 <span class="preprocessor">#ifdef INET6</span>
<a name="l00927"></a>00927 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l00928"></a>00928                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l00929"></a>00929                     <span class="keywordflow">return</span>-1;
<a name="l00930"></a>00930                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, Source Port: %u&quot;</span>,
<a name="l00931"></a>00931                        ident,
<a name="l00932"></a>00932                        ip6addr_string(obj_tptr),
<a name="l00933"></a>00933                        EXTRACT_16BITS(obj_tptr+18));
<a name="l00934"></a>00934                 obj_tlen-=20;
<a name="l00935"></a>00935                 obj_tptr+=20;
<a name="l00936"></a>00936                 <span class="keywordflow">break</span>;
<a name="l00937"></a>00937             <span class="keywordflow">case</span> RSVP_CTYPE_13: <span class="comment">/* IPv6 p2mp LSP tunnel */</span>
<a name="l00938"></a>00938                 <span class="keywordflow">if</span> (obj_tlen &lt; 40)
<a name="l00939"></a>00939                     <span class="keywordflow">return</span>-1;
<a name="l00940"></a>00940                 printf(<span class="stringliteral">&quot;%s  IPv6 Tunnel Sender Address: %s, LSP ID: 0x%04x&quot;</span>
<a name="l00941"></a>00941                        <span class="stringliteral">&quot;%s  Sub-Group Originator ID: %s, Sub-Group ID: 0x%04x&quot;</span>,
<a name="l00942"></a>00942                        ident,
<a name="l00943"></a>00943                        ip6addr_string(obj_tptr),
<a name="l00944"></a>00944                        EXTRACT_16BITS(obj_tptr+18),
<a name="l00945"></a>00945                        ident,
<a name="l00946"></a>00946                        ip6addr_string(obj_tptr+20),
<a name="l00947"></a>00947                        EXTRACT_16BITS(obj_tptr+38));
<a name="l00948"></a>00948                 obj_tlen-=40;
<a name="l00949"></a>00949                 obj_tptr+=40;
<a name="l00950"></a>00950                 <span class="keywordflow">break</span>;
<a name="l00951"></a>00951 <span class="preprocessor">#endif</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4:
<a name="l00953"></a>00953                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l00954"></a>00954                     <span class="keywordflow">return</span>-1;
<a name="l00955"></a>00955                 printf(<span class="stringliteral">&quot;%s  IPv4 Tunnel Sender Address: %s, LSP-ID: 0x%04x&quot;</span>,
<a name="l00956"></a>00956                        ident,
<a name="l00957"></a>00957                        ipaddr_string(obj_tptr),
<a name="l00958"></a>00958                        EXTRACT_16BITS(obj_tptr+6));
<a name="l00959"></a>00959                 obj_tlen-=8;
<a name="l00960"></a>00960                 obj_tptr+=8;
<a name="l00961"></a>00961                 <span class="keywordflow">break</span>;
<a name="l00962"></a>00962             <span class="keywordflow">case</span> RSVP_CTYPE_12: <span class="comment">/* IPv4 p2mp LSP tunnel */</span>
<a name="l00963"></a>00963                 <span class="keywordflow">if</span> (obj_tlen &lt; 16)
<a name="l00964"></a>00964                     <span class="keywordflow">return</span>-1;
<a name="l00965"></a>00965                 printf(<span class="stringliteral">&quot;%s  IPv4 Tunnel Sender Address: %s, LSP ID: 0x%04x&quot;</span>
<a name="l00966"></a>00966                        <span class="stringliteral">&quot;%s  Sub-Group Originator ID: %s, Sub-Group ID: 0x%04x&quot;</span>,
<a name="l00967"></a>00967                        ident,
<a name="l00968"></a>00968                        ipaddr_string(obj_tptr),
<a name="l00969"></a>00969                        EXTRACT_16BITS(obj_tptr+6),
<a name="l00970"></a>00970                        ident,
<a name="l00971"></a>00971                        ipaddr_string(obj_tptr+8),
<a name="l00972"></a>00972                        EXTRACT_16BITS(obj_tptr+12));
<a name="l00973"></a>00973                 obj_tlen-=16;
<a name="l00974"></a>00974                 obj_tptr+=16;
<a name="l00975"></a>00975                 <span class="keywordflow">break</span>;
<a name="l00976"></a>00976             <span class="keywordflow">default</span>:
<a name="l00977"></a>00977                 hexdump=TRUE;
<a name="l00978"></a>00978             }
<a name="l00979"></a>00979             <span class="keywordflow">break</span>;
<a name="l00980"></a>00980 
<a name="l00981"></a>00981         <span class="keywordflow">case</span> RSVP_OBJ_LABEL_REQ:
<a name="l00982"></a>00982             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l00983"></a>00983             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l00984"></a>00984                 <span class="keywordflow">while</span>(obj_tlen &gt;= 4 ) {
<a name="l00985"></a>00985                     printf(<span class="stringliteral">&quot;%s  L3 Protocol ID: %s&quot;</span>,
<a name="l00986"></a>00986                            ident,
<a name="l00987"></a>00987                            tok2str(ethertype_values,
<a name="l00988"></a>00988                                    <span class="stringliteral">&quot;Unknown Protocol (0x%04x)&quot;</span>,
<a name="l00989"></a>00989                                    EXTRACT_16BITS(obj_tptr+2)));
<a name="l00990"></a>00990                     obj_tlen-=4;
<a name="l00991"></a>00991                     obj_tptr+=4;
<a name="l00992"></a>00992                 }
<a name="l00993"></a>00993                 <span class="keywordflow">break</span>;
<a name="l00994"></a>00994             <span class="keywordflow">case</span> RSVP_CTYPE_2:
<a name="l00995"></a>00995                 <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l00996"></a>00996                     <span class="keywordflow">return</span>-1;
<a name="l00997"></a>00997                 printf(<span class="stringliteral">&quot;%s  L3 Protocol ID: %s&quot;</span>,
<a name="l00998"></a>00998                        ident,
<a name="l00999"></a>00999                        tok2str(ethertype_values,
<a name="l01000"></a>01000                                <span class="stringliteral">&quot;Unknown Protocol (0x%04x)&quot;</span>,
<a name="l01001"></a>01001                                EXTRACT_16BITS(obj_tptr+2)));
<a name="l01002"></a>01002                 printf(<span class="stringliteral">&quot;,%s merge capability&quot;</span>,((*(obj_tptr+4))&amp;0x80) ? <span class="stringliteral">&quot;no&quot;</span> : <span class="stringliteral">&quot;&quot;</span> );
<a name="l01003"></a>01003                 printf(<span class="stringliteral">&quot;%s  Minimum VPI/VCI: %u/%u&quot;</span>,
<a name="l01004"></a>01004                        ident,
<a name="l01005"></a>01005                        (EXTRACT_16BITS(obj_tptr+4))&amp;0xfff,
<a name="l01006"></a>01006                        (EXTRACT_16BITS(obj_tptr+6))&amp;0xfff);
<a name="l01007"></a>01007                 printf(<span class="stringliteral">&quot;%s  Maximum VPI/VCI: %u/%u&quot;</span>,
<a name="l01008"></a>01008                        ident,
<a name="l01009"></a>01009                        (EXTRACT_16BITS(obj_tptr+8))&amp;0xfff,
<a name="l01010"></a>01010                        (EXTRACT_16BITS(obj_tptr+10))&amp;0xfff);
<a name="l01011"></a>01011                 obj_tlen-=12;
<a name="l01012"></a>01012                 obj_tptr+=12;
<a name="l01013"></a>01013                 <span class="keywordflow">break</span>;
<a name="l01014"></a>01014             <span class="keywordflow">case</span> RSVP_CTYPE_3:
<a name="l01015"></a>01015                 <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l01016"></a>01016                     <span class="keywordflow">return</span>-1;
<a name="l01017"></a>01017                 printf(<span class="stringliteral">&quot;%s  L3 Protocol ID: %s&quot;</span>,
<a name="l01018"></a>01018                        ident,
<a name="l01019"></a>01019                        tok2str(ethertype_values,
<a name="l01020"></a>01020                                <span class="stringliteral">&quot;Unknown Protocol (0x%04x)&quot;</span>,
<a name="l01021"></a>01021                                EXTRACT_16BITS(obj_tptr+2)));
<a name="l01022"></a>01022                 printf(<span class="stringliteral">&quot;%s  Minimum/Maximum DLCI: %u/%u, %s%s bit DLCI&quot;</span>,
<a name="l01023"></a>01023                        ident,
<a name="l01024"></a>01024                        (EXTRACT_32BITS(obj_tptr+4))&amp;0x7fffff,
<a name="l01025"></a>01025                        (EXTRACT_32BITS(obj_tptr+8))&amp;0x7fffff,
<a name="l01026"></a>01026                        (((EXTRACT_16BITS(obj_tptr+4)&gt;&gt;7)&amp;3) == 0 ) ? <span class="stringliteral">&quot;10&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,
<a name="l01027"></a>01027                        (((EXTRACT_16BITS(obj_tptr+4)&gt;&gt;7)&amp;3) == 2 ) ? <span class="stringliteral">&quot;23&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l01028"></a>01028                 obj_tlen-=12;
<a name="l01029"></a>01029                 obj_tptr+=12;
<a name="l01030"></a>01030                 <span class="keywordflow">break</span>;
<a name="l01031"></a>01031             <span class="keywordflow">case</span> RSVP_CTYPE_4:
<a name="l01032"></a>01032                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01033"></a>01033                     <span class="keywordflow">return</span>-1;
<a name="l01034"></a>01034                 printf(<span class="stringliteral">&quot;%s  LSP Encoding Type: %s (%u)&quot;</span>,
<a name="l01035"></a>01035                        ident,
<a name="l01036"></a>01036                        tok2str(gmpls_encoding_values,
<a name="l01037"></a>01037                                <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l01038"></a>01038                                *obj_tptr),
<a name="l01039"></a>01039                *obj_tptr);
<a name="l01040"></a>01040                 printf(<span class="stringliteral">&quot;%s  Switching Type: %s (%u), Payload ID: %s (0x%04x)&quot;</span>,
<a name="l01041"></a>01041                        ident,
<a name="l01042"></a>01042                        tok2str(gmpls_switch_cap_values,
<a name="l01043"></a>01043                                <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l01044"></a>01044                                *(obj_tptr+1)),
<a name="l01045"></a>01045                *(obj_tptr+1),
<a name="l01046"></a>01046                        tok2str(gmpls_payload_values,
<a name="l01047"></a>01047                                <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l01048"></a>01048                                EXTRACT_16BITS(obj_tptr+2)),
<a name="l01049"></a>01049                EXTRACT_16BITS(obj_tptr+2));
<a name="l01050"></a>01050                 obj_tlen-=4;
<a name="l01051"></a>01051                 obj_tptr+=4;
<a name="l01052"></a>01052                 <span class="keywordflow">break</span>;
<a name="l01053"></a>01053             <span class="keywordflow">default</span>:
<a name="l01054"></a>01054                 hexdump=TRUE;
<a name="l01055"></a>01055             }
<a name="l01056"></a>01056             <span class="keywordflow">break</span>;
<a name="l01057"></a>01057 
<a name="l01058"></a>01058         <span class="keywordflow">case</span> RSVP_OBJ_RRO:
<a name="l01059"></a>01059         <span class="keywordflow">case</span> RSVP_OBJ_ERO:
<a name="l01060"></a>01060             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01061"></a>01061             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l01062"></a>01062                 <span class="keywordflow">while</span>(obj_tlen &gt;= 4 ) {
<a name="l01063"></a>01063                     printf(<span class="stringliteral">&quot;%s  Subobject Type: %s, length %u&quot;</span>,
<a name="l01064"></a>01064                            ident,
<a name="l01065"></a>01065                            tok2str(rsvp_obj_xro_values,
<a name="l01066"></a>01066                                    <span class="stringliteral">&quot;Unknown %u&quot;</span>,
<a name="l01067"></a>01067                                    RSVP_OBJ_XRO_MASK_SUBOBJ(*obj_tptr)),
<a name="l01068"></a>01068                            *(obj_tptr+1));                
<a name="l01069"></a>01069 
<a name="l01070"></a>01070                     <span class="keywordflow">if</span> (*(obj_tptr+1) == 0) { <span class="comment">/* prevent infinite loops */</span>
<a name="l01071"></a>01071                         printf(<span class="stringliteral">&quot;%s  ERROR: zero length ERO subtype&quot;</span>,ident);
<a name="l01072"></a>01072                         <span class="keywordflow">break</span>;
<a name="l01073"></a>01073                     }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075                     <span class="keywordflow">switch</span>(RSVP_OBJ_XRO_MASK_SUBOBJ(*obj_tptr)) {
<a name="l01076"></a>01076                     <span class="keywordflow">case</span> RSVP_OBJ_XRO_IPV4:
<a name="l01077"></a>01077                         printf(<span class="stringliteral">&quot;, %s, %s/%u, Flags: [%s]&quot;</span>,
<a name="l01078"></a>01078                                RSVP_OBJ_XRO_MASK_LOOSE(*obj_tptr) ? <span class="stringliteral">&quot;Loose&quot;</span> : <span class="stringliteral">&quot;Strict&quot;</span>,
<a name="l01079"></a>01079                                ipaddr_string(obj_tptr+2),
<a name="l01080"></a>01080                                *(obj_tptr+6),
<a name="l01081"></a>01081                                bittok2str(rsvp_obj_rro_flag_values,
<a name="l01082"></a>01082                                    <span class="stringliteral">&quot;none&quot;</span>,
<a name="l01083"></a>01083                                    *(obj_tptr+7))); <span class="comment">/* rfc3209 says that this field is rsvd. */</span>
<a name="l01084"></a>01084                     <span class="keywordflow">break</span>;
<a name="l01085"></a>01085                     <span class="keywordflow">case</span> RSVP_OBJ_XRO_LABEL:
<a name="l01086"></a>01086                         printf(<span class="stringliteral">&quot;, Flags: [%s] (%#x), Class-Type: %s (%u), %u&quot;</span>,
<a name="l01087"></a>01087                                bittok2str(rsvp_obj_rro_label_flag_values,
<a name="l01088"></a>01088                                    <span class="stringliteral">&quot;none&quot;</span>,
<a name="l01089"></a>01089                                    *(obj_tptr+2)),
<a name="l01090"></a>01090                                *(obj_tptr+2),
<a name="l01091"></a>01091                                tok2str(rsvp_ctype_values,
<a name="l01092"></a>01092                                        <span class="stringliteral">&quot;Unknown&quot;</span>,
<a name="l01093"></a>01093                                        *(obj_tptr+3) + 256*RSVP_OBJ_RRO),
<a name="l01094"></a>01094                                *(obj_tptr+3),
<a name="l01095"></a>01095                                EXTRACT_32BITS(obj_tptr+4));
<a name="l01096"></a>01096                     }
<a name="l01097"></a>01097                     obj_tlen-=*(obj_tptr+1);
<a name="l01098"></a>01098                     obj_tptr+=*(obj_tptr+1);
<a name="l01099"></a>01099                 }
<a name="l01100"></a>01100                 <span class="keywordflow">break</span>;
<a name="l01101"></a>01101             <span class="keywordflow">default</span>:
<a name="l01102"></a>01102                 hexdump=TRUE;
<a name="l01103"></a>01103             }
<a name="l01104"></a>01104             <span class="keywordflow">break</span>;
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         <span class="keywordflow">case</span> RSVP_OBJ_HELLO:
<a name="l01107"></a>01107             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01108"></a>01108             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01109"></a>01109             <span class="keywordflow">case</span> RSVP_CTYPE_2:
<a name="l01110"></a>01110                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01111"></a>01111                     <span class="keywordflow">return</span>-1;
<a name="l01112"></a>01112                 printf(<span class="stringliteral">&quot;%s  Source Instance: 0x%08x, Destination Instance: 0x%08x&quot;</span>,
<a name="l01113"></a>01113                        ident,
<a name="l01114"></a>01114                        EXTRACT_32BITS(obj_tptr),
<a name="l01115"></a>01115                        EXTRACT_32BITS(obj_tptr+4));
<a name="l01116"></a>01116                 obj_tlen-=8;
<a name="l01117"></a>01117                 obj_tptr+=8;
<a name="l01118"></a>01118                 <span class="keywordflow">break</span>;
<a name="l01119"></a>01119             <span class="keywordflow">default</span>:
<a name="l01120"></a>01120                 hexdump=TRUE;
<a name="l01121"></a>01121             }
<a name="l01122"></a>01122             <span class="keywordflow">break</span>;
<a name="l01123"></a>01123 
<a name="l01124"></a>01124         <span class="keywordflow">case</span> RSVP_OBJ_RESTART_CAPABILITY:
<a name="l01125"></a>01125             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01126"></a>01126             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01127"></a>01127                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01128"></a>01128                     <span class="keywordflow">return</span>-1;
<a name="l01129"></a>01129                 printf(<span class="stringliteral">&quot;%s  Restart  Time: %ums, Recovery Time: %ums&quot;</span>,
<a name="l01130"></a>01130                        ident,
<a name="l01131"></a>01131                        EXTRACT_32BITS(obj_tptr),
<a name="l01132"></a>01132                        EXTRACT_32BITS(obj_tptr+4));
<a name="l01133"></a>01133                 obj_tlen-=8;
<a name="l01134"></a>01134                 obj_tptr+=8;
<a name="l01135"></a>01135                 <span class="keywordflow">break</span>;
<a name="l01136"></a>01136             <span class="keywordflow">default</span>:
<a name="l01137"></a>01137                 hexdump=TRUE;
<a name="l01138"></a>01138             }
<a name="l01139"></a>01139             <span class="keywordflow">break</span>;
<a name="l01140"></a>01140 
<a name="l01141"></a>01141         <span class="keywordflow">case</span> RSVP_OBJ_SESSION_ATTRIBUTE:
<a name="l01142"></a>01142             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01143"></a>01143             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4:
<a name="l01144"></a>01144                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01145"></a>01145                     <span class="keywordflow">return</span>-1;
<a name="l01146"></a>01146                 namelen = *(obj_tptr+3);
<a name="l01147"></a>01147                 <span class="keywordflow">if</span> (obj_tlen &lt; 4+namelen)
<a name="l01148"></a>01148                     <span class="keywordflow">return</span>-1;
<a name="l01149"></a>01149                 printf(<span class="stringliteral">&quot;%s  Session Name: &quot;</span>, ident);
<a name="l01150"></a>01150                 <span class="keywordflow">for</span> (i = 0; i &lt; namelen; i++)
<a name="l01151"></a>01151                     safeputchar(*(obj_tptr+4+i));
<a name="l01152"></a>01152                 printf(<span class="stringliteral">&quot;%s  Setup Priority: %u, Holding Priority: %u, Flags: [%s] (%#x)&quot;</span>,
<a name="l01153"></a>01153                        ident,
<a name="l01154"></a>01154                        (<span class="keywordtype">int</span>)*obj_tptr,
<a name="l01155"></a>01155                        (<span class="keywordtype">int</span>)*(obj_tptr+1),
<a name="l01156"></a>01156                        bittok2str(rsvp_session_attribute_flag_values,
<a name="l01157"></a>01157                                   <span class="stringliteral">&quot;none&quot;</span>,
<a name="l01158"></a>01158                                   *(obj_tptr+2)),
<a name="l01159"></a>01159                        *(obj_tptr+2));
<a name="l01160"></a>01160                 obj_tlen-=4+*(obj_tptr+3);
<a name="l01161"></a>01161                 obj_tptr+=4+*(obj_tptr+3);
<a name="l01162"></a>01162                 <span class="keywordflow">break</span>;
<a name="l01163"></a>01163             <span class="keywordflow">default</span>:
<a name="l01164"></a>01164                 hexdump=TRUE;
<a name="l01165"></a>01165             }
<a name="l01166"></a>01166             <span class="keywordflow">break</span>;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168     <span class="keywordflow">case</span> RSVP_OBJ_GENERALIZED_UNI:
<a name="l01169"></a>01169             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01170"></a>01170         <span class="keywordtype">int</span> subobj_type,af,subobj_len,total_subobj_len;
<a name="l01171"></a>01171 
<a name="l01172"></a>01172             <span class="keywordflow">case</span> RSVP_CTYPE_1: 
<a name="l01173"></a>01173 
<a name="l01174"></a>01174                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01175"></a>01175                     <span class="keywordflow">return</span>-1;
<a name="l01176"></a>01176 
<a name="l01177"></a>01177         <span class="comment">/* read variable length subobjects */</span>
<a name="l01178"></a>01178         total_subobj_len = obj_tlen;
<a name="l01179"></a>01179                 <span class="keywordflow">while</span>(total_subobj_len &gt; 0) {
<a name="l01180"></a>01180                     subobj_len  = EXTRACT_16BITS(obj_tptr);
<a name="l01181"></a>01181                     subobj_type = (EXTRACT_16BITS(obj_tptr+2))&gt;&gt;8;
<a name="l01182"></a>01182                     af = (EXTRACT_16BITS(obj_tptr+2))&amp;0x00FF;
<a name="l01183"></a>01183 
<a name="l01184"></a>01184                     printf(<span class="stringliteral">&quot;%s  Subobject Type: %s (%u), AF: %s (%u), length: %u&quot;</span>,
<a name="l01185"></a>01185                            ident,
<a name="l01186"></a>01186                            tok2str(rsvp_obj_generalized_uni_values, <span class="stringliteral">&quot;Unknown&quot;</span>, subobj_type),
<a name="l01187"></a>01187                            subobj_type,
<a name="l01188"></a>01188                            tok2str(af_values, <span class="stringliteral">&quot;Unknown&quot;</span>, af), af,
<a name="l01189"></a>01189                            subobj_len);
<a name="l01190"></a>01190 
<a name="l01191"></a>01191                     <span class="keywordflow">switch</span>(subobj_type) {
<a name="l01192"></a>01192                     <span class="keywordflow">case</span> RSVP_GEN_UNI_SUBOBJ_SOURCE_TNA_ADDRESS:
<a name="l01193"></a>01193                     <span class="keywordflow">case</span> RSVP_GEN_UNI_SUBOBJ_DESTINATION_TNA_ADDRESS:
<a name="l01194"></a>01194 
<a name="l01195"></a>01195                         <span class="keywordflow">switch</span>(af) {
<a name="l01196"></a>01196                         <span class="keywordflow">case</span> AFNUM_INET:
<a name="l01197"></a>01197                             <span class="keywordflow">if</span> (subobj_len &lt; 8)
<a name="l01198"></a>01198                                 <span class="keywordflow">return</span> -1;
<a name="l01199"></a>01199                             printf(<span class="stringliteral">&quot;%s    UNI IPv4 TNA address: %s&quot;</span>,
<a name="l01200"></a>01200                                    ident, ipaddr_string(obj_tptr+4));
<a name="l01201"></a>01201                             <span class="keywordflow">break</span>;
<a name="l01202"></a>01202 <span class="preprocessor">#ifdef INET6</span>
<a name="l01203"></a>01203 <span class="preprocessor"></span>                        <span class="keywordflow">case</span> AFNUM_INET6:
<a name="l01204"></a>01204                             <span class="keywordflow">if</span> (subobj_len &lt; 20)
<a name="l01205"></a>01205                                 <span class="keywordflow">return</span> -1;
<a name="l01206"></a>01206                             printf(<span class="stringliteral">&quot;%s    UNI IPv6 TNA address: %s&quot;</span>,
<a name="l01207"></a>01207                                    ident, ip6addr_string(obj_tptr+4));
<a name="l01208"></a>01208                             <span class="keywordflow">break</span>;
<a name="l01209"></a>01209 <span class="preprocessor">#endif</span>
<a name="l01210"></a>01210 <span class="preprocessor"></span>                        <span class="keywordflow">case</span> AFNUM_NSAP:
<a name="l01211"></a>01211                             <span class="keywordflow">if</span> (subobj_len) {
<a name="l01212"></a>01212                                 <span class="comment">/* unless we have a TLV parser lets just hexdump */</span>
<a name="l01213"></a>01213                                 hexdump=TRUE;
<a name="l01214"></a>01214                             }
<a name="l01215"></a>01215                             <span class="keywordflow">break</span>;
<a name="l01216"></a>01216                         }
<a name="l01217"></a>01217                         <span class="keywordflow">break</span>;
<a name="l01218"></a>01218 
<a name="l01219"></a>01219                     <span class="keywordflow">case</span> RSVP_GEN_UNI_SUBOBJ_DIVERSITY:
<a name="l01220"></a>01220                         <span class="keywordflow">if</span> (subobj_len) {
<a name="l01221"></a>01221                             <span class="comment">/* unless we have a TLV parser lets just hexdump */</span>
<a name="l01222"></a>01222                             hexdump=TRUE;
<a name="l01223"></a>01223                         }
<a name="l01224"></a>01224                         <span class="keywordflow">break</span>;
<a name="l01225"></a>01225 
<a name="l01226"></a>01226                     <span class="keywordflow">case</span> RSVP_GEN_UNI_SUBOBJ_EGRESS_LABEL:
<a name="l01227"></a>01227                         <span class="keywordflow">if</span> (subobj_len &lt; 16) {
<a name="l01228"></a>01228                             <span class="keywordflow">return</span> -1;
<a name="l01229"></a>01229                         }
<a name="l01230"></a>01230 
<a name="l01231"></a>01231                         printf(<span class="stringliteral">&quot;%s    U-bit: %x, Label type: %u, Logical port id: %u, Label: %u&quot;</span>,
<a name="l01232"></a>01232                                ident,
<a name="l01233"></a>01233                                ((EXTRACT_32BITS(obj_tptr+4))&gt;&gt;31),
<a name="l01234"></a>01234                                ((EXTRACT_32BITS(obj_tptr+4))&amp;0xFF),
<a name="l01235"></a>01235                                EXTRACT_32BITS(obj_tptr+8),
<a name="l01236"></a>01236                                EXTRACT_32BITS(obj_tptr+12));
<a name="l01237"></a>01237                         <span class="keywordflow">break</span>;
<a name="l01238"></a>01238 
<a name="l01239"></a>01239                     <span class="keywordflow">case</span> RSVP_GEN_UNI_SUBOBJ_SERVICE_LEVEL:
<a name="l01240"></a>01240                         <span class="keywordflow">if</span> (subobj_len &lt; 8) {
<a name="l01241"></a>01241                             <span class="keywordflow">return</span> -1;
<a name="l01242"></a>01242                         }
<a name="l01243"></a>01243 
<a name="l01244"></a>01244                         printf(<span class="stringliteral">&quot;%s    Service level: %u&quot;</span>,
<a name="l01245"></a>01245                                ident, (EXTRACT_32BITS(obj_tptr+4))&gt;&gt;24);
<a name="l01246"></a>01246                         <span class="keywordflow">break</span>;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248                     <span class="keywordflow">default</span>:
<a name="l01249"></a>01249                         hexdump=TRUE;
<a name="l01250"></a>01250                         <span class="keywordflow">break</span>;
<a name="l01251"></a>01251                     }
<a name="l01252"></a>01252                     total_subobj_len-=subobj_len;
<a name="l01253"></a>01253                     obj_tptr+=subobj_len;
<a name="l01254"></a>01254                     obj_tlen+=subobj_len;
<a name="l01255"></a>01255         }
<a name="l01256"></a>01256 
<a name="l01257"></a>01257                 <span class="keywordflow">if</span> (total_subobj_len) {
<a name="l01258"></a>01258                     <span class="comment">/* unless we have a TLV parser lets just hexdump */</span>
<a name="l01259"></a>01259                     hexdump=TRUE;
<a name="l01260"></a>01260                 }
<a name="l01261"></a>01261                 <span class="keywordflow">break</span>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263             <span class="keywordflow">default</span>:
<a name="l01264"></a>01264                 hexdump=TRUE;
<a name="l01265"></a>01265             }
<a name="l01266"></a>01266             <span class="keywordflow">break</span>;
<a name="l01267"></a>01267 
<a name="l01268"></a>01268         <span class="keywordflow">case</span> RSVP_OBJ_RSVP_HOP:
<a name="l01269"></a>01269             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01270"></a>01270             <span class="keywordflow">case</span> RSVP_CTYPE_3: <span class="comment">/* fall through - FIXME add TLV parser */</span>
<a name="l01271"></a>01271             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l01272"></a>01272                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01273"></a>01273                     <span class="keywordflow">return</span>-1;
<a name="l01274"></a>01274                 printf(<span class="stringliteral">&quot;%s  Previous/Next Interface: %s, Logical Interface Handle: 0x%08x&quot;</span>,
<a name="l01275"></a>01275                        ident,
<a name="l01276"></a>01276                        ipaddr_string(obj_tptr),
<a name="l01277"></a>01277                        EXTRACT_32BITS(obj_tptr+4));
<a name="l01278"></a>01278                 obj_tlen-=8;
<a name="l01279"></a>01279                 obj_tptr+=8;
<a name="l01280"></a>01280                 <span class="keywordflow">if</span> (obj_tlen)
<a name="l01281"></a>01281                     hexdump=TRUE; <span class="comment">/* unless we have a TLV parser lets just hexdump */</span>
<a name="l01282"></a>01282                 <span class="keywordflow">break</span>;
<a name="l01283"></a>01283 <span class="preprocessor">#ifdef INET6</span>
<a name="l01284"></a>01284 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_4: <span class="comment">/* fall through - FIXME add TLV parser */</span>
<a name="l01285"></a>01285             <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l01286"></a>01286                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l01287"></a>01287                     <span class="keywordflow">return</span>-1;
<a name="l01288"></a>01288                 printf(<span class="stringliteral">&quot;%s  Previous/Next Interface: %s, Logical Interface Handle: 0x%08x&quot;</span>,
<a name="l01289"></a>01289                        ident,
<a name="l01290"></a>01290                        ip6addr_string(obj_tptr),
<a name="l01291"></a>01291                        EXTRACT_32BITS(obj_tptr+16));
<a name="l01292"></a>01292                 obj_tlen-=20;
<a name="l01293"></a>01293                 obj_tptr+=20;
<a name="l01294"></a>01294                 hexdump=TRUE; <span class="comment">/* unless we have a TLV parser lets just hexdump */</span>
<a name="l01295"></a>01295                 <span class="keywordflow">break</span>;
<a name="l01296"></a>01296 <span class="preprocessor">#endif</span>
<a name="l01297"></a>01297 <span class="preprocessor"></span>            <span class="keywordflow">default</span>:
<a name="l01298"></a>01298                 hexdump=TRUE;
<a name="l01299"></a>01299             }
<a name="l01300"></a>01300             <span class="keywordflow">break</span>;
<a name="l01301"></a>01301 
<a name="l01302"></a>01302         <span class="keywordflow">case</span> RSVP_OBJ_TIME_VALUES:
<a name="l01303"></a>01303             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01304"></a>01304             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01305"></a>01305                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01306"></a>01306                     <span class="keywordflow">return</span>-1;
<a name="l01307"></a>01307                 printf(<span class="stringliteral">&quot;%s  Refresh Period: %ums&quot;</span>,
<a name="l01308"></a>01308                        ident,
<a name="l01309"></a>01309                        EXTRACT_32BITS(obj_tptr));
<a name="l01310"></a>01310                 obj_tlen-=4;
<a name="l01311"></a>01311                 obj_tptr+=4;
<a name="l01312"></a>01312                 <span class="keywordflow">break</span>;
<a name="l01313"></a>01313             <span class="keywordflow">default</span>:
<a name="l01314"></a>01314                 hexdump=TRUE;
<a name="l01315"></a>01315             }
<a name="l01316"></a>01316             <span class="keywordflow">break</span>;
<a name="l01317"></a>01317 
<a name="l01318"></a>01318         <span class="comment">/* those three objects do share the same semantics */</span>
<a name="l01319"></a>01319         <span class="keywordflow">case</span> RSVP_OBJ_SENDER_TSPEC:
<a name="l01320"></a>01320         <span class="keywordflow">case</span> RSVP_OBJ_ADSPEC:
<a name="l01321"></a>01321         <span class="keywordflow">case</span> RSVP_OBJ_FLOWSPEC:
<a name="l01322"></a>01322             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01323"></a>01323             <span class="keywordflow">case</span> RSVP_CTYPE_2:
<a name="l01324"></a>01324                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01325"></a>01325                     <span class="keywordflow">return</span>-1;
<a name="l01326"></a>01326                 printf(<span class="stringliteral">&quot;%s  Msg-Version: %u, length: %u&quot;</span>,
<a name="l01327"></a>01327                        ident,
<a name="l01328"></a>01328                        (*obj_tptr &amp; 0xf0) &gt;&gt; 4,
<a name="l01329"></a>01329                        EXTRACT_16BITS(obj_tptr+2)&lt;&lt;2);
<a name="l01330"></a>01330                 obj_tptr+=4; <span class="comment">/* get to the start of the service header */</span>
<a name="l01331"></a>01331                 obj_tlen-=4;
<a name="l01332"></a>01332 
<a name="l01333"></a>01333                 <span class="keywordflow">while</span> (obj_tlen &gt;= 4) {
<a name="l01334"></a>01334                     intserv_serv_tlen=EXTRACT_16BITS(obj_tptr+2)&lt;&lt;2;
<a name="l01335"></a>01335                     printf(<span class="stringliteral">&quot;%s  Service Type: %s (%u), break bit %s set, Service length: %u&quot;</span>,
<a name="l01336"></a>01336                            ident,
<a name="l01337"></a>01337                            tok2str(rsvp_intserv_service_type_values,<span class="stringliteral">&quot;unknown&quot;</span>,*(obj_tptr)),
<a name="l01338"></a>01338                            *(obj_tptr),
<a name="l01339"></a>01339                            (*(obj_tptr+1)&amp;0x80) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;not&quot;</span>,
<a name="l01340"></a>01340                            intserv_serv_tlen);
<a name="l01341"></a>01341                     
<a name="l01342"></a>01342                     obj_tptr+=4; <span class="comment">/* get to the start of the parameter list */</span>
<a name="l01343"></a>01343                     obj_tlen-=4;
<a name="l01344"></a>01344 
<a name="l01345"></a>01345                     <span class="keywordflow">while</span> (intserv_serv_tlen&gt;=4) {
<a name="l01346"></a>01346                         processed = rsvp_intserv_print(obj_tptr, obj_tlen);
<a name="l01347"></a>01347                         <span class="keywordflow">if</span> (processed == 0)
<a name="l01348"></a>01348                             <span class="keywordflow">break</span>;
<a name="l01349"></a>01349                         obj_tlen-=processed;
<a name="l01350"></a>01350                         intserv_serv_tlen-=processed;
<a name="l01351"></a>01351                         obj_tptr+=processed;
<a name="l01352"></a>01352                     }
<a name="l01353"></a>01353                 }
<a name="l01354"></a>01354                 <span class="keywordflow">break</span>;
<a name="l01355"></a>01355             <span class="keywordflow">default</span>:
<a name="l01356"></a>01356                 hexdump=TRUE;
<a name="l01357"></a>01357             }
<a name="l01358"></a>01358             <span class="keywordflow">break</span>;
<a name="l01359"></a>01359 
<a name="l01360"></a>01360         <span class="keywordflow">case</span> RSVP_OBJ_FILTERSPEC:
<a name="l01361"></a>01361             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01362"></a>01362             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l01363"></a>01363                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01364"></a>01364                     <span class="keywordflow">return</span>-1;
<a name="l01365"></a>01365                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, Source Port: %u&quot;</span>,
<a name="l01366"></a>01366                        ident,
<a name="l01367"></a>01367                        ipaddr_string(obj_tptr),
<a name="l01368"></a>01368                        EXTRACT_16BITS(obj_tptr+6));
<a name="l01369"></a>01369                 obj_tlen-=8;
<a name="l01370"></a>01370                 obj_tptr+=8;
<a name="l01371"></a>01371                 <span class="keywordflow">break</span>;
<a name="l01372"></a>01372 <span class="preprocessor">#ifdef INET6</span>
<a name="l01373"></a>01373 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l01374"></a>01374                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l01375"></a>01375                     <span class="keywordflow">return</span>-1;
<a name="l01376"></a>01376                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, Source Port: %u&quot;</span>,
<a name="l01377"></a>01377                        ident,
<a name="l01378"></a>01378                        ip6addr_string(obj_tptr),
<a name="l01379"></a>01379                        EXTRACT_16BITS(obj_tptr+18));
<a name="l01380"></a>01380                 obj_tlen-=20;
<a name="l01381"></a>01381                 obj_tptr+=20;
<a name="l01382"></a>01382                 <span class="keywordflow">break</span>;
<a name="l01383"></a>01383             <span class="keywordflow">case</span> RSVP_CTYPE_3:
<a name="l01384"></a>01384                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l01385"></a>01385                     <span class="keywordflow">return</span>-1;
<a name="l01386"></a>01386                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, Flow Label: %u&quot;</span>,
<a name="l01387"></a>01387                        ident,
<a name="l01388"></a>01388                        ip6addr_string(obj_tptr),
<a name="l01389"></a>01389                        EXTRACT_24BITS(obj_tptr+17));
<a name="l01390"></a>01390                 obj_tlen-=20;
<a name="l01391"></a>01391                 obj_tptr+=20;
<a name="l01392"></a>01392                 <span class="keywordflow">break</span>;
<a name="l01393"></a>01393             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV6:
<a name="l01394"></a>01394                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l01395"></a>01395                     <span class="keywordflow">return</span>-1;
<a name="l01396"></a>01396                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, LSP-ID: 0x%04x&quot;</span>,
<a name="l01397"></a>01397                        ident,
<a name="l01398"></a>01398                        ipaddr_string(obj_tptr),
<a name="l01399"></a>01399                        EXTRACT_16BITS(obj_tptr+18));
<a name="l01400"></a>01400                 obj_tlen-=20;
<a name="l01401"></a>01401                 obj_tptr+=20;
<a name="l01402"></a>01402                 <span class="keywordflow">break</span>;
<a name="l01403"></a>01403             <span class="keywordflow">case</span> RSVP_CTYPE_13: <span class="comment">/* IPv6 p2mp LSP tunnel */</span>
<a name="l01404"></a>01404                 <span class="keywordflow">if</span> (obj_tlen &lt; 40)
<a name="l01405"></a>01405                     <span class="keywordflow">return</span>-1;
<a name="l01406"></a>01406                 printf(<span class="stringliteral">&quot;%s  IPv6 Tunnel Sender Address: %s, LSP ID: 0x%04x&quot;</span>
<a name="l01407"></a>01407                        <span class="stringliteral">&quot;%s  Sub-Group Originator ID: %s, Sub-Group ID: 0x%04x&quot;</span>,
<a name="l01408"></a>01408                        ident,
<a name="l01409"></a>01409                        ip6addr_string(obj_tptr),
<a name="l01410"></a>01410                        EXTRACT_16BITS(obj_tptr+18),
<a name="l01411"></a>01411                        ident,
<a name="l01412"></a>01412                        ip6addr_string(obj_tptr+20),
<a name="l01413"></a>01413                        EXTRACT_16BITS(obj_tptr+38));
<a name="l01414"></a>01414                 obj_tlen-=40;
<a name="l01415"></a>01415                 obj_tptr+=40;
<a name="l01416"></a>01416                 <span class="keywordflow">break</span>;
<a name="l01417"></a>01417 <span class="preprocessor">#endif</span>
<a name="l01418"></a>01418 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4:
<a name="l01419"></a>01419                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01420"></a>01420                     <span class="keywordflow">return</span>-1;
<a name="l01421"></a>01421                 printf(<span class="stringliteral">&quot;%s  Source Address: %s, LSP-ID: 0x%04x&quot;</span>,
<a name="l01422"></a>01422                        ident,
<a name="l01423"></a>01423                        ipaddr_string(obj_tptr),
<a name="l01424"></a>01424                        EXTRACT_16BITS(obj_tptr+6));
<a name="l01425"></a>01425                 obj_tlen-=8;
<a name="l01426"></a>01426                 obj_tptr+=8;
<a name="l01427"></a>01427                 <span class="keywordflow">break</span>;
<a name="l01428"></a>01428             <span class="keywordflow">case</span> RSVP_CTYPE_12: <span class="comment">/* IPv4 p2mp LSP tunnel */</span>
<a name="l01429"></a>01429                 <span class="keywordflow">if</span> (obj_tlen &lt; 16)
<a name="l01430"></a>01430                     <span class="keywordflow">return</span>-1;
<a name="l01431"></a>01431                 printf(<span class="stringliteral">&quot;%s  IPv4 Tunnel Sender Address: %s, LSP ID: 0x%04x&quot;</span>
<a name="l01432"></a>01432                        <span class="stringliteral">&quot;%s  Sub-Group Originator ID: %s, Sub-Group ID: 0x%04x&quot;</span>,
<a name="l01433"></a>01433                        ident,
<a name="l01434"></a>01434                        ipaddr_string(obj_tptr),
<a name="l01435"></a>01435                        EXTRACT_16BITS(obj_tptr+6),
<a name="l01436"></a>01436                        ident,
<a name="l01437"></a>01437                        ipaddr_string(obj_tptr+8),
<a name="l01438"></a>01438                        EXTRACT_16BITS(obj_tptr+12));
<a name="l01439"></a>01439                 obj_tlen-=16;
<a name="l01440"></a>01440                 obj_tptr+=16;
<a name="l01441"></a>01441                 <span class="keywordflow">break</span>;
<a name="l01442"></a>01442             <span class="keywordflow">default</span>:
<a name="l01443"></a>01443                 hexdump=TRUE;
<a name="l01444"></a>01444             }
<a name="l01445"></a>01445             <span class="keywordflow">break</span>;
<a name="l01446"></a>01446 
<a name="l01447"></a>01447         <span class="keywordflow">case</span> RSVP_OBJ_FASTREROUTE:
<a name="l01448"></a>01448             <span class="comment">/* the differences between c-type 1 and 7 are minor */</span>
<a name="l01449"></a>01449             obj_ptr.rsvp_obj_frr = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a> *)obj_tptr;
<a name="l01450"></a>01450             bw.i = EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;bandwidth);
<a name="l01451"></a>01451 
<a name="l01452"></a>01452             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01453"></a>01453             <span class="keywordflow">case</span> RSVP_CTYPE_1: <span class="comment">/* new style */</span>
<a name="l01454"></a>01454                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a>))
<a name="l01455"></a>01455                     <span class="keywordflow">return</span>-1;
<a name="l01456"></a>01456                 printf(<span class="stringliteral">&quot;%s  Setup Priority: %u, Holding Priority: %u, Hop-limit: %u, Bandwidth: %.10g Mbps&quot;</span>,
<a name="l01457"></a>01457                        ident,
<a name="l01458"></a>01458                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;setup_prio,
<a name="l01459"></a>01459                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;hold_prio,
<a name="l01460"></a>01460                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;hop_limit,
<a name="l01461"></a>01461                         bw.f*8/1000000);              
<a name="l01462"></a>01462                 printf(<span class="stringliteral">&quot;%s  Include-any: 0x%08x, Exclude-any: 0x%08x, Include-all: 0x%08x&quot;</span>,
<a name="l01463"></a>01463                        ident,
<a name="l01464"></a>01464                        EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;include_any),
<a name="l01465"></a>01465                        EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;exclude_any),
<a name="l01466"></a>01466                        EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;include_all));
<a name="l01467"></a>01467                 obj_tlen-=<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a>);
<a name="l01468"></a>01468                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__obj__frr__t.html">rsvp_obj_frr_t</a>);
<a name="l01469"></a>01469                 <span class="keywordflow">break</span>;
<a name="l01470"></a>01470 
<a name="l01471"></a>01471             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4: <span class="comment">/* old style */</span>
<a name="l01472"></a>01472                 <span class="keywordflow">if</span> (obj_tlen &lt; 16)
<a name="l01473"></a>01473                     <span class="keywordflow">return</span>-1;
<a name="l01474"></a>01474                 printf(<span class="stringliteral">&quot;%s  Setup Priority: %u, Holding Priority: %u, Hop-limit: %u, Bandwidth: %.10g Mbps&quot;</span>,
<a name="l01475"></a>01475                        ident,
<a name="l01476"></a>01476                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;setup_prio,
<a name="l01477"></a>01477                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;hold_prio,
<a name="l01478"></a>01478                        (<span class="keywordtype">int</span>)obj_ptr.rsvp_obj_frr-&gt;hop_limit,
<a name="l01479"></a>01479                         bw.f*8/1000000);              
<a name="l01480"></a>01480                 printf(<span class="stringliteral">&quot;%s  Include Colors: 0x%08x, Exclude Colors: 0x%08x&quot;</span>,
<a name="l01481"></a>01481                        ident,
<a name="l01482"></a>01482                        EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;include_any),
<a name="l01483"></a>01483                        EXTRACT_32BITS(obj_ptr.rsvp_obj_frr-&gt;exclude_any));
<a name="l01484"></a>01484                 obj_tlen-=16;
<a name="l01485"></a>01485                 obj_tptr+=16;
<a name="l01486"></a>01486                 <span class="keywordflow">break</span>;
<a name="l01487"></a>01487 
<a name="l01488"></a>01488             <span class="keywordflow">default</span>:
<a name="l01489"></a>01489                 hexdump=TRUE;
<a name="l01490"></a>01490             }
<a name="l01491"></a>01491             <span class="keywordflow">break</span>;
<a name="l01492"></a>01492 
<a name="l01493"></a>01493         <span class="keywordflow">case</span> RSVP_OBJ_DETOUR:
<a name="l01494"></a>01494             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01495"></a>01495             <span class="keywordflow">case</span> RSVP_CTYPE_TUNNEL_IPV4:
<a name="l01496"></a>01496                 <span class="keywordflow">while</span>(obj_tlen &gt;= 8) {
<a name="l01497"></a>01497                     printf(<span class="stringliteral">&quot;%s  PLR-ID: %s, Avoid-Node-ID: %s&quot;</span>,
<a name="l01498"></a>01498                            ident,
<a name="l01499"></a>01499                            ipaddr_string(obj_tptr),
<a name="l01500"></a>01500                            ipaddr_string(obj_tptr+4));              
<a name="l01501"></a>01501                     obj_tlen-=8;
<a name="l01502"></a>01502                     obj_tptr+=8;
<a name="l01503"></a>01503                 }
<a name="l01504"></a>01504                 <span class="keywordflow">break</span>;
<a name="l01505"></a>01505             <span class="keywordflow">default</span>:
<a name="l01506"></a>01506                 hexdump=TRUE;
<a name="l01507"></a>01507             }
<a name="l01508"></a>01508             <span class="keywordflow">break</span>;
<a name="l01509"></a>01509 
<a name="l01510"></a>01510         <span class="keywordflow">case</span> RSVP_OBJ_CLASSTYPE:
<a name="l01511"></a>01511         <span class="keywordflow">case</span> RSVP_OBJ_CLASSTYPE_OLD: <span class="comment">/* fall through */</span>
<a name="l01512"></a>01512             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01513"></a>01513             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01514"></a>01514                 printf(<span class="stringliteral">&quot;%s  CT: %u&quot;</span>,
<a name="l01515"></a>01515                        ident,
<a name="l01516"></a>01516                        EXTRACT_32BITS(obj_tptr)&amp;0x7);              
<a name="l01517"></a>01517                 obj_tlen-=4;
<a name="l01518"></a>01518                 obj_tptr+=4;
<a name="l01519"></a>01519                 <span class="keywordflow">break</span>;
<a name="l01520"></a>01520             <span class="keywordflow">default</span>:
<a name="l01521"></a>01521                 hexdump=TRUE;
<a name="l01522"></a>01522             }
<a name="l01523"></a>01523             <span class="keywordflow">break</span>;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525         <span class="keywordflow">case</span> RSVP_OBJ_ERROR_SPEC:
<a name="l01526"></a>01526             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01527"></a>01527             <span class="keywordflow">case</span> RSVP_CTYPE_3: <span class="comment">/* fall through - FIXME add TLV parser */</span>
<a name="l01528"></a>01528             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4:
<a name="l01529"></a>01529                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01530"></a>01530                     <span class="keywordflow">return</span>-1;
<a name="l01531"></a>01531                 error_code=*(obj_tptr+5);
<a name="l01532"></a>01532                 error_value=EXTRACT_16BITS(obj_tptr+6);
<a name="l01533"></a>01533                 printf(<span class="stringliteral">&quot;%s  Error Node Address: %s, Flags: [0x%02x]%s  Error Code: %s (%u)&quot;</span>,
<a name="l01534"></a>01534                        ident,
<a name="l01535"></a>01535                        ipaddr_string(obj_tptr),
<a name="l01536"></a>01536                        *(obj_tptr+4),
<a name="l01537"></a>01537                        ident,
<a name="l01538"></a>01538                        tok2str(rsvp_obj_error_code_values,<span class="stringliteral">&quot;unknown&quot;</span>,error_code),
<a name="l01539"></a>01539                        error_code);
<a name="l01540"></a>01540                 <span class="keywordflow">switch</span> (error_code) {
<a name="l01541"></a>01541                 <span class="keywordflow">case</span> RSVP_OBJ_ERROR_SPEC_CODE_ROUTING:
<a name="l01542"></a>01542                     printf(<span class="stringliteral">&quot;, Error Value: %s (%u)&quot;</span>,
<a name="l01543"></a>01543                            tok2str(rsvp_obj_error_code_routing_values,<span class="stringliteral">&quot;unknown&quot;</span>,error_value),
<a name="l01544"></a>01544                            error_value);
<a name="l01545"></a>01545                     <span class="keywordflow">break</span>;
<a name="l01546"></a>01546                 <span class="keywordflow">case</span> RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE: <span class="comment">/* fall through */</span>
<a name="l01547"></a>01547                 <span class="keywordflow">case</span> RSVP_OBJ_ERROR_SPEC_CODE_DIFFSERV_TE_OLD:
<a name="l01548"></a>01548                     printf(<span class="stringliteral">&quot;, Error Value: %s (%u)&quot;</span>,
<a name="l01549"></a>01549                            tok2str(rsvp_obj_error_code_diffserv_te_values,<span class="stringliteral">&quot;unknown&quot;</span>,error_value),
<a name="l01550"></a>01550                            error_value);
<a name="l01551"></a>01551                     <span class="keywordflow">break</span>;
<a name="l01552"></a>01552                 <span class="keywordflow">default</span>:
<a name="l01553"></a>01553                     printf(<span class="stringliteral">&quot;, Unknown Error Value (%u)&quot;</span>, error_value);
<a name="l01554"></a>01554                     <span class="keywordflow">break</span>;
<a name="l01555"></a>01555                 }
<a name="l01556"></a>01556                 obj_tlen-=8;
<a name="l01557"></a>01557                 obj_tptr+=8;
<a name="l01558"></a>01558                 <span class="keywordflow">break</span>;
<a name="l01559"></a>01559 <span class="preprocessor">#ifdef INET6</span>
<a name="l01560"></a>01560 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_4: <span class="comment">/* fall through - FIXME add TLV parser */</span>
<a name="l01561"></a>01561             <span class="keywordflow">case</span> RSVP_CTYPE_IPV6:
<a name="l01562"></a>01562                 <span class="keywordflow">if</span> (obj_tlen &lt; 20)
<a name="l01563"></a>01563                     <span class="keywordflow">return</span>-1;
<a name="l01564"></a>01564                 error_code=*(obj_tptr+17);
<a name="l01565"></a>01565                 error_value=EXTRACT_16BITS(obj_tptr+18);
<a name="l01566"></a>01566                 printf(<span class="stringliteral">&quot;%s  Error Node Address: %s, Flags: [0x%02x]%s  Error Code: %s (%u)&quot;</span>,
<a name="l01567"></a>01567                        ident,
<a name="l01568"></a>01568                        ip6addr_string(obj_tptr),
<a name="l01569"></a>01569                        *(obj_tptr+16),
<a name="l01570"></a>01570                        ident,
<a name="l01571"></a>01571                        tok2str(rsvp_obj_error_code_values,<span class="stringliteral">&quot;unknown&quot;</span>,error_code),
<a name="l01572"></a>01572                        error_code);
<a name="l01573"></a>01573 
<a name="l01574"></a>01574                 <span class="keywordflow">switch</span> (error_code) {
<a name="l01575"></a>01575                 <span class="keywordflow">case</span> RSVP_OBJ_ERROR_SPEC_CODE_ROUTING:
<a name="l01576"></a>01576                     printf(<span class="stringliteral">&quot;, Error Value: %s (%u)&quot;</span>,
<a name="l01577"></a>01577                            tok2str(rsvp_obj_error_code_routing_values,<span class="stringliteral">&quot;unknown&quot;</span>,error_value),
<a name="l01578"></a>01578                error_value);
<a name="l01579"></a>01579                     <span class="keywordflow">break</span>;
<a name="l01580"></a>01580                 <span class="keywordflow">default</span>:
<a name="l01581"></a>01581                     <span class="keywordflow">break</span>;
<a name="l01582"></a>01582                 }
<a name="l01583"></a>01583                 obj_tlen-=20;
<a name="l01584"></a>01584                 obj_tptr+=20;
<a name="l01585"></a>01585                 <span class="keywordflow">break</span>;
<a name="l01586"></a>01586 <span class="preprocessor">#endif</span>
<a name="l01587"></a>01587 <span class="preprocessor"></span>            <span class="keywordflow">default</span>:
<a name="l01588"></a>01588                 hexdump=TRUE;
<a name="l01589"></a>01589             }
<a name="l01590"></a>01590             <span class="keywordflow">break</span>;
<a name="l01591"></a>01591 
<a name="l01592"></a>01592         <span class="keywordflow">case</span> RSVP_OBJ_PROPERTIES:
<a name="l01593"></a>01593             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01594"></a>01594             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01595"></a>01595                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01596"></a>01596                     <span class="keywordflow">return</span>-1;
<a name="l01597"></a>01597                 padbytes = EXTRACT_16BITS(obj_tptr+2);
<a name="l01598"></a>01598                 printf(<span class="stringliteral">&quot;%s  TLV count: %u, padding bytes: %u&quot;</span>,
<a name="l01599"></a>01599                        ident,
<a name="l01600"></a>01600                        EXTRACT_16BITS(obj_tptr),
<a name="l01601"></a>01601                        padbytes);
<a name="l01602"></a>01602                 obj_tlen-=4;
<a name="l01603"></a>01603                 obj_tptr+=4;
<a name="l01604"></a>01604                 <span class="comment">/* loop through as long there is anything longer than the TLV header (2) */</span>
<a name="l01605"></a>01605                 <span class="keywordflow">while</span>(obj_tlen &gt;= 2 + padbytes) {
<a name="l01606"></a>01606                     printf(<span class="stringliteral">&quot;%s    %s TLV (0x%02x), length: %u&quot;</span>, <span class="comment">/* length includes header */</span>
<a name="l01607"></a>01607                            ident,
<a name="l01608"></a>01608                            tok2str(rsvp_obj_prop_tlv_values,<span class="stringliteral">&quot;unknown&quot;</span>,*obj_tptr),
<a name="l01609"></a>01609                            *obj_tptr,
<a name="l01610"></a>01610                            *(obj_tptr+1));
<a name="l01611"></a>01611                     <span class="keywordflow">if</span> (obj_tlen &lt; *(obj_tptr+1))
<a name="l01612"></a>01612                         <span class="keywordflow">return</span>-1;
<a name="l01613"></a>01613                     <span class="keywordflow">if</span> (*(obj_tptr+1) &lt; 2)
<a name="l01614"></a>01614                         <span class="keywordflow">return</span> -1;
<a name="l01615"></a>01615                     print_unknown_data(obj_tptr+2,<span class="stringliteral">&quot;\n\t\t&quot;</span>,*(obj_tptr+1)-2);
<a name="l01616"></a>01616                     obj_tlen-=*(obj_tptr+1);
<a name="l01617"></a>01617                     obj_tptr+=*(obj_tptr+1);
<a name="l01618"></a>01618                 }
<a name="l01619"></a>01619                 <span class="keywordflow">break</span>;
<a name="l01620"></a>01620             <span class="keywordflow">default</span>:
<a name="l01621"></a>01621                 hexdump=TRUE;
<a name="l01622"></a>01622             }
<a name="l01623"></a>01623             <span class="keywordflow">break</span>;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         <span class="keywordflow">case</span> RSVP_OBJ_MESSAGE_ID:     <span class="comment">/* fall through */</span>
<a name="l01626"></a>01626         <span class="keywordflow">case</span> RSVP_OBJ_MESSAGE_ID_ACK: <span class="comment">/* fall through */</span>
<a name="l01627"></a>01627         <span class="keywordflow">case</span> RSVP_OBJ_MESSAGE_ID_LIST:
<a name="l01628"></a>01628             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01629"></a>01629             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01630"></a>01630             <span class="keywordflow">case</span> RSVP_CTYPE_2:
<a name="l01631"></a>01631                 <span class="keywordflow">if</span> (obj_tlen &lt; 8)
<a name="l01632"></a>01632                     <span class="keywordflow">return</span>-1;
<a name="l01633"></a>01633                 printf(<span class="stringliteral">&quot;%s  Flags [0x%02x], epoch: %u&quot;</span>,
<a name="l01634"></a>01634                        ident,
<a name="l01635"></a>01635                        *obj_tptr,
<a name="l01636"></a>01636                        EXTRACT_24BITS(obj_tptr+1));
<a name="l01637"></a>01637                 obj_tlen-=4;
<a name="l01638"></a>01638                 obj_tptr+=4;
<a name="l01639"></a>01639                 <span class="comment">/* loop through as long there are no messages left */</span>
<a name="l01640"></a>01640                 <span class="keywordflow">while</span>(obj_tlen &gt;= 4) {
<a name="l01641"></a>01641                     printf(<span class="stringliteral">&quot;%s    Message-ID 0x%08x (%u)&quot;</span>,
<a name="l01642"></a>01642                            ident,
<a name="l01643"></a>01643                            EXTRACT_32BITS(obj_tptr),
<a name="l01644"></a>01644                            EXTRACT_32BITS(obj_tptr));
<a name="l01645"></a>01645                     obj_tlen-=4;
<a name="l01646"></a>01646                     obj_tptr+=4;
<a name="l01647"></a>01647                 }
<a name="l01648"></a>01648                 <span class="keywordflow">break</span>;
<a name="l01649"></a>01649             <span class="keywordflow">default</span>:
<a name="l01650"></a>01650                 hexdump=TRUE;
<a name="l01651"></a>01651             }
<a name="l01652"></a>01652             <span class="keywordflow">break</span>;
<a name="l01653"></a>01653 
<a name="l01654"></a>01654         <span class="keywordflow">case</span> RSVP_OBJ_INTEGRITY:
<a name="l01655"></a>01655             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01656"></a>01656             <span class="keywordflow">case</span> RSVP_CTYPE_1:
<a name="l01657"></a>01657                 <span class="keywordflow">if</span> (obj_tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a>))
<a name="l01658"></a>01658                     <span class="keywordflow">return</span>-1;
<a name="l01659"></a>01659                 obj_ptr.rsvp_obj_integrity = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a> *)obj_tptr;
<a name="l01660"></a>01660                 printf(<span class="stringliteral">&quot;%s  Key-ID 0x%04x%08x, Sequence 0x%08x%08x, Flags [%s]&quot;</span>,
<a name="l01661"></a>01661                        ident,
<a name="l01662"></a>01662                        EXTRACT_16BITS(obj_ptr.rsvp_obj_integrity-&gt;key_id),
<a name="l01663"></a>01663                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;key_id+2),
<a name="l01664"></a>01664                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;sequence),
<a name="l01665"></a>01665                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;sequence+4),
<a name="l01666"></a>01666                        bittok2str(rsvp_obj_integrity_flag_values,
<a name="l01667"></a>01667                                   <span class="stringliteral">&quot;none&quot;</span>,
<a name="l01668"></a>01668                                   obj_ptr.rsvp_obj_integrity-&gt;flags));
<a name="l01669"></a>01669                 printf(<span class="stringliteral">&quot;%s  MD5-sum 0x%08x%08x%08x%08x &quot;</span>,
<a name="l01670"></a>01670                        ident,
<a name="l01671"></a>01671                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;digest),
<a name="l01672"></a>01672                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;digest+4),
<a name="l01673"></a>01673                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;digest+8),
<a name="l01674"></a>01674                        EXTRACT_32BITS(obj_ptr.rsvp_obj_integrity-&gt;digest+12));
<a name="l01675"></a>01675 
<a name="l01676"></a>01676 <span class="preprocessor">#ifdef HAVE_LIBCRYPTO</span>
<a name="l01677"></a>01677 <span class="preprocessor"></span>                sigcheck = signature_verify(pptr, plen, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)obj_ptr.\
<a name="l01678"></a>01678                                              rsvp_obj_integrity-&gt;digest);
<a name="l01679"></a>01679 <span class="preprocessor">#else</span>
<a name="l01680"></a>01680 <span class="preprocessor"></span>                sigcheck = CANT_CHECK_SIGNATURE;
<a name="l01681"></a>01681 <span class="preprocessor">#endif</span>
<a name="l01682"></a>01682 <span class="preprocessor"></span>                printf(<span class="stringliteral">&quot; (%s)&quot;</span>, tok2str(signature_check_values, <span class="stringliteral">&quot;Unknown&quot;</span>, sigcheck));
<a name="l01683"></a>01683 
<a name="l01684"></a>01684                 obj_tlen+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a>);
<a name="l01685"></a>01685                 obj_tptr+=<span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrsvp__obj__integrity__t.html">rsvp_obj_integrity_t</a>);
<a name="l01686"></a>01686                 <span class="keywordflow">break</span>;
<a name="l01687"></a>01687             <span class="keywordflow">default</span>:
<a name="l01688"></a>01688                 hexdump=TRUE;
<a name="l01689"></a>01689             }
<a name="l01690"></a>01690             <span class="keywordflow">break</span>;           
<a name="l01691"></a>01691 
<a name="l01692"></a>01692         <span class="keywordflow">case</span> RSVP_OBJ_ADMIN_STATUS:
<a name="l01693"></a>01693             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01694"></a>01694             <span class="keywordflow">case</span> RSVP_CTYPE_1: 
<a name="l01695"></a>01695                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01696"></a>01696                     <span class="keywordflow">return</span>-1;
<a name="l01697"></a>01697                 printf(<span class="stringliteral">&quot;%s  Flags [%s]&quot;</span>, ident,
<a name="l01698"></a>01698                        bittok2str(rsvp_obj_admin_status_flag_values, <span class="stringliteral">&quot;none&quot;</span>,
<a name="l01699"></a>01699                                   EXTRACT_32BITS(obj_tptr)));
<a name="l01700"></a>01700                 obj_tlen-=4;
<a name="l01701"></a>01701                 obj_tptr+=4;
<a name="l01702"></a>01702                 <span class="keywordflow">break</span>;
<a name="l01703"></a>01703             <span class="keywordflow">default</span>:
<a name="l01704"></a>01704                 hexdump=TRUE;
<a name="l01705"></a>01705             }
<a name="l01706"></a>01706             <span class="keywordflow">break</span>;
<a name="l01707"></a>01707 
<a name="l01708"></a>01708         <span class="keywordflow">case</span> RSVP_OBJ_LABEL_SET:
<a name="l01709"></a>01709             <span class="keywordflow">switch</span>(rsvp_obj_ctype) {
<a name="l01710"></a>01710             <span class="keywordflow">case</span> RSVP_CTYPE_1: 
<a name="l01711"></a>01711                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01712"></a>01712                     <span class="keywordflow">return</span>-1;
<a name="l01713"></a>01713                 action = (EXTRACT_16BITS(obj_tptr)&gt;&gt;8);
<a name="l01714"></a>01714 
<a name="l01715"></a>01715                 printf(<span class="stringliteral">&quot;%s  Action: %s (%u), Label type: %u&quot;</span>, ident,
<a name="l01716"></a>01716                        tok2str(rsvp_obj_label_set_action_values, <span class="stringliteral">&quot;Unknown&quot;</span>, action),
<a name="l01717"></a>01717                        action, ((EXTRACT_32BITS(obj_tptr) &amp; 0x7F)));
<a name="l01718"></a>01718 
<a name="l01719"></a>01719                 <span class="keywordflow">switch</span> (action) {
<a name="l01720"></a>01720                 <span class="keywordflow">case</span> LABEL_SET_INCLUSIVE_RANGE:
<a name="l01721"></a>01721                 <span class="keywordflow">case</span> LABEL_SET_EXCLUSIVE_RANGE: <span class="comment">/* fall through */</span>
<a name="l01722"></a>01722 
<a name="l01723"></a>01723             <span class="comment">/* only a couple of subchannels are expected */</span>
<a name="l01724"></a>01724             <span class="keywordflow">if</span> (obj_tlen &lt; 12)
<a name="l01725"></a>01725             <span class="keywordflow">return</span> -1;
<a name="l01726"></a>01726             printf(<span class="stringliteral">&quot;%s  Start range: %u, End range: %u&quot;</span>, ident,
<a name="l01727"></a>01727                            EXTRACT_32BITS(obj_tptr+4),
<a name="l01728"></a>01728                            EXTRACT_32BITS(obj_tptr+8));
<a name="l01729"></a>01729             obj_tlen-=12;
<a name="l01730"></a>01730             obj_tptr+=12;
<a name="l01731"></a>01731                     <span class="keywordflow">break</span>;
<a name="l01732"></a>01732 
<a name="l01733"></a>01733                 <span class="keywordflow">default</span>:
<a name="l01734"></a>01734                     obj_tlen-=4;
<a name="l01735"></a>01735                     obj_tptr+=4;
<a name="l01736"></a>01736                     subchannel = 1;
<a name="l01737"></a>01737                     <span class="keywordflow">while</span>(obj_tlen &gt;= 4 ) {
<a name="l01738"></a>01738                         printf(<span class="stringliteral">&quot;%s  Subchannel #%u: %u&quot;</span>, ident, subchannel,
<a name="l01739"></a>01739                                EXTRACT_32BITS(obj_tptr));
<a name="l01740"></a>01740                         obj_tptr+=4;
<a name="l01741"></a>01741                         obj_tlen-=4;
<a name="l01742"></a>01742                         subchannel++;
<a name="l01743"></a>01743                     }
<a name="l01744"></a>01744                     <span class="keywordflow">break</span>;
<a name="l01745"></a>01745                 }
<a name="l01746"></a>01746                 <span class="keywordflow">break</span>;
<a name="l01747"></a>01747             <span class="keywordflow">default</span>:
<a name="l01748"></a>01748                 hexdump=TRUE;
<a name="l01749"></a>01749             }
<a name="l01750"></a>01750 
<a name="l01751"></a>01751         <span class="keywordflow">case</span> RSVP_OBJ_S2L:
<a name="l01752"></a>01752             <span class="keywordflow">switch</span> (rsvp_obj_ctype) {
<a name="l01753"></a>01753             <span class="keywordflow">case</span> RSVP_CTYPE_IPV4: 
<a name="l01754"></a>01754                 <span class="keywordflow">if</span> (obj_tlen &lt; 4)
<a name="l01755"></a>01755                     <span class="keywordflow">return</span>-1;
<a name="l01756"></a>01756                 printf(<span class="stringliteral">&quot;%s  Sub-LSP destination address: %s&quot;</span>,
<a name="l01757"></a>01757                        ident, ipaddr_string(obj_tptr));
<a name="l01758"></a>01758 
<a name="l01759"></a>01759                 obj_tlen-=4;
<a name="l01760"></a>01760                 obj_tptr+=4;
<a name="l01761"></a>01761                 <span class="keywordflow">break</span>;
<a name="l01762"></a>01762 <span class="preprocessor">#ifdef INET6</span>
<a name="l01763"></a>01763 <span class="preprocessor"></span>            <span class="keywordflow">case</span> RSVP_CTYPE_IPV6: 
<a name="l01764"></a>01764                 <span class="keywordflow">if</span> (obj_tlen &lt; 16)
<a name="l01765"></a>01765                     <span class="keywordflow">return</span>-1;
<a name="l01766"></a>01766                 printf(<span class="stringliteral">&quot;%s  Sub-LSP destination address: %s&quot;</span>,
<a name="l01767"></a>01767                        ident, ip6addr_string(obj_tptr));
<a name="l01768"></a>01768 
<a name="l01769"></a>01769                 obj_tlen-=16;
<a name="l01770"></a>01770                 obj_tptr+=16;
<a name="l01771"></a>01771                 <span class="keywordflow">break</span>;
<a name="l01772"></a>01772 <span class="preprocessor">#endif</span>
<a name="l01773"></a>01773 <span class="preprocessor"></span>            <span class="keywordflow">default</span>:
<a name="l01774"></a>01774                 hexdump=TRUE;
<a name="l01775"></a>01775             }
<a name="l01776"></a>01776 
<a name="l01777"></a>01777         <span class="comment">/*</span>
<a name="l01778"></a>01778 <span class="comment">         *  FIXME those are the defined objects that lack a decoder</span>
<a name="l01779"></a>01779 <span class="comment">         *  you are welcome to contribute code ;-)</span>
<a name="l01780"></a>01780 <span class="comment">         */</span>
<a name="l01781"></a>01781 
<a name="l01782"></a>01782         <span class="keywordflow">case</span> RSVP_OBJ_SCOPE:
<a name="l01783"></a>01783         <span class="keywordflow">case</span> RSVP_OBJ_POLICY_DATA:
<a name="l01784"></a>01784         <span class="keywordflow">case</span> RSVP_OBJ_ACCEPT_LABEL_SET:
<a name="l01785"></a>01785         <span class="keywordflow">case</span> RSVP_OBJ_PROTECTION:
<a name="l01786"></a>01786         <span class="keywordflow">default</span>:
<a name="l01787"></a>01787             <span class="keywordflow">if</span> (vflag &lt;= 1)
<a name="l01788"></a>01788                 print_unknown_data(obj_tptr,<span class="stringliteral">&quot;\n\t    &quot;</span>,obj_tlen); <span class="comment">/* FIXME indentation */</span>
<a name="l01789"></a>01789             <span class="keywordflow">break</span>;
<a name="l01790"></a>01790         }
<a name="l01791"></a>01791         <span class="comment">/* do we also want to see a hex dump ? */</span>
<a name="l01792"></a>01792         <span class="keywordflow">if</span> (vflag &gt; 1 || hexdump==TRUE)
<a name="l01793"></a>01793             print_unknown_data(tptr+<span class="keyword">sizeof</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>)),<span class="stringliteral">&quot;\n\t    &quot;</span>, <span class="comment">/* FIXME indentation */</span>
<a name="l01794"></a>01794                                rsvp_obj_len-<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrsvp__object__header.html">rsvp_object_header</a>));
<a name="l01795"></a>01795 
<a name="l01796"></a>01796         tptr+=rsvp_obj_len;
<a name="l01797"></a>01797         tlen-=rsvp_obj_len;
<a name="l01798"></a>01798     }
<a name="l01799"></a>01799     <span class="keywordflow">return</span> 0;
<a name="l01800"></a>01800 trunc:
<a name="l01801"></a>01801     printf(<span class="stringliteral">&quot;\n\t\t packet exceeded snapshot&quot;</span>);
<a name="l01802"></a>01802     <span class="keywordflow">return</span> -1;
<a name="l01803"></a>01803 }
<a name="l01804"></a>01804 
<a name="l01805"></a>01805 
<a name="l01806"></a>01806 <span class="keywordtype">void</span>
<a name="l01807"></a>01807 rsvp_print(<span class="keyword">register</span> <span class="keyword">const</span> u_char *pptr, <span class="keyword">register</span> u_int len) {
<a name="l01808"></a>01808 
<a name="l01809"></a>01809     <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a> *rsvp_com_header;
<a name="l01810"></a>01810     <span class="keyword">const</span> u_char *tptr,*subtptr;
<a name="l01811"></a>01811     u_short plen, tlen, subtlen;
<a name="l01812"></a>01812 
<a name="l01813"></a>01813     tptr=pptr;
<a name="l01814"></a>01814 
<a name="l01815"></a>01815     rsvp_com_header = (<span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a> *)pptr;
<a name="l01816"></a>01816     TCHECK(*rsvp_com_header);
<a name="l01817"></a>01817 
<a name="l01818"></a>01818     <span class="comment">/*</span>
<a name="l01819"></a>01819 <span class="comment">     * Sanity checking of the header.</span>
<a name="l01820"></a>01820 <span class="comment">     */</span>
<a name="l01821"></a>01821     <span class="keywordflow">if</span> (RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags) != RSVP_VERSION) {
<a name="l01822"></a>01822     printf(<span class="stringliteral">&quot;ERROR: RSVP version %u packet not supported&quot;</span>,
<a name="l01823"></a>01823                RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags));
<a name="l01824"></a>01824     <span class="keywordflow">return</span>;
<a name="l01825"></a>01825     }
<a name="l01826"></a>01826 
<a name="l01827"></a>01827     <span class="comment">/* in non-verbose mode just lets print the basic Message Type*/</span>
<a name="l01828"></a>01828     <span class="keywordflow">if</span> (vflag &lt; 1) {
<a name="l01829"></a>01829         printf(<span class="stringliteral">&quot;RSVPv%u %s Message, length: %u&quot;</span>,
<a name="l01830"></a>01830                RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags),
<a name="l01831"></a>01831                tok2str(rsvp_msg_type_values, <span class="stringliteral">&quot;unknown (%u)&quot;</span>,rsvp_com_header-&gt;msg_type),
<a name="l01832"></a>01832                len);
<a name="l01833"></a>01833         <span class="keywordflow">return</span>;
<a name="l01834"></a>01834     }
<a name="l01835"></a>01835 
<a name="l01836"></a>01836     <span class="comment">/* ok they seem to want to know everything - lets fully decode it */</span>
<a name="l01837"></a>01837 
<a name="l01838"></a>01838     plen = tlen = EXTRACT_16BITS(rsvp_com_header-&gt;length);
<a name="l01839"></a>01839 
<a name="l01840"></a>01840     printf(<span class="stringliteral">&quot;\n\tRSVPv%u %s Message (%u), Flags: [%s], length: %u, ttl: %u, checksum: 0x%04x&quot;</span>,
<a name="l01841"></a>01841            RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags),
<a name="l01842"></a>01842            tok2str(rsvp_msg_type_values, <span class="stringliteral">&quot;unknown, type: %u&quot;</span>,rsvp_com_header-&gt;msg_type),
<a name="l01843"></a>01843            rsvp_com_header-&gt;msg_type,
<a name="l01844"></a>01844            bittok2str(rsvp_header_flag_values,<span class="stringliteral">&quot;none&quot;</span>,RSVP_EXTRACT_FLAGS(rsvp_com_header-&gt;version_flags)),
<a name="l01845"></a>01845            tlen,
<a name="l01846"></a>01846            rsvp_com_header-&gt;ttl,
<a name="l01847"></a>01847            EXTRACT_16BITS(rsvp_com_header-&gt;checksum));
<a name="l01848"></a>01848 
<a name="l01849"></a>01849     <span class="comment">/*</span>
<a name="l01850"></a>01850 <span class="comment">     * Clear checksum prior to signature verification.</span>
<a name="l01851"></a>01851 <span class="comment">     */</span>
<a name="l01852"></a>01852     rsvp_com_header-&gt;checksum[0] = 0;
<a name="l01853"></a>01853     rsvp_com_header-&gt;checksum[1] = 0;
<a name="l01854"></a>01854 
<a name="l01855"></a>01855     <span class="keywordflow">if</span> (tlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>)) {
<a name="l01856"></a>01856         printf(<span class="stringliteral">&quot;ERROR: common header too short %u &lt; %lu&quot;</span>, tlen,
<a name="l01857"></a>01857                (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>));
<a name="l01858"></a>01858         <span class="keywordflow">return</span>;
<a name="l01859"></a>01859     }
<a name="l01860"></a>01860 
<a name="l01861"></a>01861     tptr+=<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01862"></a>01862     tlen-=<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <span class="keywordflow">switch</span>(rsvp_com_header-&gt;msg_type) {
<a name="l01865"></a>01865 
<a name="l01866"></a>01866     <span class="keywordflow">case</span> RSVP_MSGTYPE_AGGREGATE:
<a name="l01867"></a>01867         <span class="keywordflow">while</span>(tlen &gt; 0) {
<a name="l01868"></a>01868             subtptr=tptr;
<a name="l01869"></a>01869             rsvp_com_header = (<span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a> *)subtptr;
<a name="l01870"></a>01870             TCHECK(*rsvp_com_header);
<a name="l01871"></a>01871 
<a name="l01872"></a>01872             <span class="comment">/*</span>
<a name="l01873"></a>01873 <span class="comment">             * Sanity checking of the header.</span>
<a name="l01874"></a>01874 <span class="comment">             */</span>
<a name="l01875"></a>01875             <span class="keywordflow">if</span> (RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags) != RSVP_VERSION) {
<a name="l01876"></a>01876                 printf(<span class="stringliteral">&quot;ERROR: RSVP version %u packet not supported&quot;</span>,
<a name="l01877"></a>01877                        RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags));
<a name="l01878"></a>01878                 <span class="keywordflow">return</span>;
<a name="l01879"></a>01879             }
<a name="l01880"></a>01880             subtlen=EXTRACT_16BITS(rsvp_com_header-&gt;length);
<a name="l01881"></a>01881             
<a name="l01882"></a>01882             printf(<span class="stringliteral">&quot;\n\t  RSVPv%u %s Message (%u), Flags: [%s], length: %u, ttl: %u, checksum: 0x%04x&quot;</span>,
<a name="l01883"></a>01883                    RSVP_EXTRACT_VERSION(rsvp_com_header-&gt;version_flags),
<a name="l01884"></a>01884                    tok2str(rsvp_msg_type_values, <span class="stringliteral">&quot;unknown, type: %u&quot;</span>,rsvp_com_header-&gt;msg_type),
<a name="l01885"></a>01885                    rsvp_com_header-&gt;msg_type,
<a name="l01886"></a>01886                    bittok2str(rsvp_header_flag_values,<span class="stringliteral">&quot;none&quot;</span>,RSVP_EXTRACT_FLAGS(rsvp_com_header-&gt;version_flags)),
<a name="l01887"></a>01887                    subtlen,
<a name="l01888"></a>01888                    rsvp_com_header-&gt;ttl,
<a name="l01889"></a>01889                    EXTRACT_16BITS(rsvp_com_header-&gt;checksum));
<a name="l01890"></a>01890 
<a name="l01891"></a>01891             <span class="comment">/*</span>
<a name="l01892"></a>01892 <span class="comment">             * Clear checksum prior to signature verification.</span>
<a name="l01893"></a>01893 <span class="comment">             */</span>
<a name="l01894"></a>01894             rsvp_com_header-&gt;checksum[0] = 0;
<a name="l01895"></a>01895             rsvp_com_header-&gt;checksum[1] = 0;
<a name="l01896"></a>01896             
<a name="l01897"></a>01897             <span class="keywordflow">if</span> (subtlen &lt; <span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>)) {
<a name="l01898"></a>01898                 printf(<span class="stringliteral">&quot;ERROR: common header too short %u &lt; %lu&quot;</span>, subtlen,
<a name="l01899"></a>01899                        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>));
<a name="l01900"></a>01900                 <span class="keywordflow">return</span>;
<a name="l01901"></a>01901             }
<a name="l01902"></a>01902 
<a name="l01903"></a>01903             <span class="keywordflow">if</span> (tlen &lt; subtlen) {
<a name="l01904"></a>01904                 printf(<span class="stringliteral">&quot;ERROR: common header too large %u &gt; %u&quot;</span>, subtlen,
<a name="l01905"></a>01905                        tlen);
<a name="l01906"></a>01906                 <span class="keywordflow">return</span>;
<a name="l01907"></a>01907             }
<a name="l01908"></a>01908 
<a name="l01909"></a>01909             subtptr+=<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01910"></a>01910             subtlen-=<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01911"></a>01911 
<a name="l01912"></a>01912             <span class="keywordflow">if</span> (rsvp_obj_print(pptr, plen, subtptr,<span class="stringliteral">&quot;\n\t    &quot;</span>, subtlen) == -1)
<a name="l01913"></a>01913                 <span class="keywordflow">return</span>;
<a name="l01914"></a>01914 
<a name="l01915"></a>01915             tptr+=subtlen+<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01916"></a>01916             tlen-=subtlen+<span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrsvp__common__header.html">rsvp_common_header</a>);
<a name="l01917"></a>01917         }
<a name="l01918"></a>01918 
<a name="l01919"></a>01919         <span class="keywordflow">break</span>;
<a name="l01920"></a>01920 
<a name="l01921"></a>01921     <span class="keywordflow">case</span> RSVP_MSGTYPE_PATH:
<a name="l01922"></a>01922     <span class="keywordflow">case</span> RSVP_MSGTYPE_RESV:
<a name="l01923"></a>01923     <span class="keywordflow">case</span> RSVP_MSGTYPE_PATHERR:
<a name="l01924"></a>01924     <span class="keywordflow">case</span> RSVP_MSGTYPE_RESVERR:
<a name="l01925"></a>01925     <span class="keywordflow">case</span> RSVP_MSGTYPE_PATHTEAR:
<a name="l01926"></a>01926     <span class="keywordflow">case</span> RSVP_MSGTYPE_RESVTEAR:
<a name="l01927"></a>01927     <span class="keywordflow">case</span> RSVP_MSGTYPE_RESVCONF:
<a name="l01928"></a>01928     <span class="keywordflow">case</span> RSVP_MSGTYPE_HELLO_OLD:
<a name="l01929"></a>01929     <span class="keywordflow">case</span> RSVP_MSGTYPE_HELLO:
<a name="l01930"></a>01930     <span class="keywordflow">case</span> RSVP_MSGTYPE_ACK:
<a name="l01931"></a>01931     <span class="keywordflow">case</span> RSVP_MSGTYPE_SREFRESH:
<a name="l01932"></a>01932         <span class="keywordflow">if</span> (rsvp_obj_print(pptr, plen, tptr,<span class="stringliteral">&quot;\n\t  &quot;</span>, tlen) == -1)
<a name="l01933"></a>01933             <span class="keywordflow">return</span>;
<a name="l01934"></a>01934         <span class="keywordflow">break</span>;
<a name="l01935"></a>01935 
<a name="l01936"></a>01936     <span class="keywordflow">default</span>: 
<a name="l01937"></a>01937         print_unknown_data(tptr,<span class="stringliteral">&quot;\n\t    &quot;</span>,tlen);  
<a name="l01938"></a>01938         <span class="keywordflow">break</span>;
<a name="l01939"></a>01939     }
<a name="l01940"></a>01940 
<a name="l01941"></a>01941     <span class="keywordflow">return</span>;
<a name="l01942"></a>01942 trunc:
<a name="l01943"></a>01943     printf(<span class="stringliteral">&quot;\n\t\t packet exceeded snapshot&quot;</span>);
<a name="l01944"></a>01944 }
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Sep 28 2011 14:20:33 for Mark6 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
